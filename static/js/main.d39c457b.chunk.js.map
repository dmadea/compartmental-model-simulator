{"version":3,"sources":["logo.svg","Slider.js","initCondTable.js","ratesTable.js","textArea.js","rk.js","general_model.js","models.js","graph.js","App.js","reportWebVitals.js","index.js","rk45.js"],"names":["useStyles","makeStyles","root","width","input","MySlider","withStyles","thumb","backgroundColor","border","active","Slider","roundToSignificantFigures","num","n","d","Math","ceil","log10","power","floor","magnitude","round","InputSlider","steps","min","max","color","log","type","index","value","sliderChangedCallback","sliderLogToggledCallback","disabled","classes","linStep","logStep","inputStep","exp","Grid","container","spacing","alignItems","item","xs","ToggleButton","selected","onChange","event","newValue","new_val","aria-labelledby","step","Input","margin","className","target","Number","inputProps","InitCondTable","data","TableContainer","component","Paper","Table","size","aria-label","TableHead","TableRow","TableCell","align","TableBody","map","entry","math","texName","errorColor","init","RatesTable","log_fr","min_fr","max_fr","fr","log_br","min_br","max_br","br","TextArea","schemeText","modelSubmitCallback","textChangedCallback","TextareaAutosize","placeholder","style","fontSize","fontFamily","Button","variant","onClick","Error","rk45","require","Array","prototype","equals","console","warn","array","this","length","i","l","Object","defineProperty","enumerable","GeneralModel","initial_conditions","elem_reactions","scheme","func","diffEquations","diffEquationsFRates","latexModel","latexModelFRates","from_comp","to_comp","forward_rate","backward_rate","comment","reaction","el","push","names","forEach","comp","includes","result","getCompartments","c","replaceAll","backwardRates","noColor","rateNames","comps","fComps","getLatexFormattedCompartments","dict","getRateNames","eqs","fFromComps","fToComps","occursFC","occurences","occursTC","key","fArrowFW","fArrowF","eq","join","finalModel","range","useZeroBR","j","values","forward_rates","backward_rates","solver","System","setStart","setStop","setInitX","setH","setFn","t","solve","idx_from","idx_to","includeBackwardRates","compsF","comps_len","posTerms","negTerms","forward_prod","backward_prod","fList","k","bList","occursF","occursB","posOccurs","allOccurs","terms","sign","numStr","abs","inv_dict","r","_forward_rates","_backward_rates","i_from","i_to","_buildDiffEq","_buildLatexModel","dc_dt","fill","subtractOccurences","_model","split","line","trim","white_space_filter","match","sides","side","tokens","plusIndices","m","re","s","exec","deleted","startIdx","endIdx","splice","splitSide","lastIdx","substring","token","containsNum","number","parseInt","name","addElementaryReaction","kineticModels","class","description","nonZeroBackwardRates","initialConditions","A","logSlider","B","C","D","E","F","G","H","I","J","K","Rabbit","Wolf","DeadWolf","rates","forwardRate","backwardRate","forwardRateMin","forwardRateMax","backwardRateMin","backwardRateMax","forwardRateLogSlider","backwardRateLogSlider","Susceptible","Infected","Recovered","Dead","Exposed","S","ES","P","PlotlyGraph","layout","config","frames","revision","useResizeHandler","height","App","state","initData","ratesData","figure","xaxis","title","showgrid","zeroline","linecolor","linewidth","mirror","yaxis","autosize","scrollZoom","responsive","texEquation","texModel","cbNonZero","model","modelSubmitted","bind","sliderValueChanged","cbNonZero_checkedChanged","modelChanged","solution","simulateModel","diff","x","y","mode","pop","xVals","yVals","text","setState","selecteModel","lastInitData","lastRatesData","fromText","init_value","condition","fr_val","br_val","buildFunc","simulModel","alert","f_val","parseFloat","objectChosen","checked","direction","Autocomplete","options","sort","a","b","localeCompare","groupBy","option","getOptionLabel","renderInput","params","TextField","label","FormControlLabel","control","Checkbox","React","Component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","debug","exports","x0","fn","newX","h","tol","start","stop","R","delta","count","maxCount","status","success","message","initX","fn_array","start_time","stop_time","setTol","setMaxCount","getStatus","checkSetUp","computeK","t_new","x_new","slice","dimension","f_vals","pow","apply"],"mappings":"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","file":"static/js/main.d39c457b.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","import React from 'react';\r\nimport { withStyles, makeStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\n// import Typography from '@material-ui/core/Typography';\r\nimport Slider from '@material-ui/core/Slider';\r\nimport Input from '@material-ui/core/Input';\r\nimport ToggleButton from '@material-ui/lab/ToggleButton';\r\n// import VolumeUp from '@material-ui/icons/VolumeUp';\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    width: 250,\r\n  },\r\n  input: {\r\n    width: 100,\r\n  },\r\n});\r\n\r\n// const useStyles = makeStyles({\r\n//   root: {\r\n//         color: '#ff0000',\r\n//   },\r\n//   thumb: {\r\n//        backgroundColor: '#fff',\r\n//        border: '3px solid currentColor',\r\n//      },\r\n\r\n// })\r\n\r\n\r\nconst MySlider = withStyles({\r\n  thumb: {\r\n    backgroundColor: '#ffffff',\r\n    border: '3px solid currentColor',\r\n  },\r\n  active: {},\r\n})(Slider);\r\n\r\nfunction round(value, digits) {\r\n  return Math.round((value + Number.EPSILON) * 10**digits) / 10**digits\r\n}\r\n\r\n// https://stackoverflow.com/questions/202302/rounding-to-an-arbitrary-number-of-significant-digits\r\nfunction roundToSignificantFigures(num, n) {\r\n  if(num == 0) {\r\n      return 0;\r\n  }\r\n\r\n  let d = Math.ceil(Math.log10(num < 0 ? -num: num));\r\n  let power = n - Math.floor(d);\r\n\r\n  let magnitude = 10 ** power;\r\n  let shifted = Math.round(num * magnitude);\r\n  return shifted / magnitude;\r\n}\r\n\r\n\r\n// const RedSlider = withStyles({\r\n//   root: {\r\n//     color: '#ff0000',\r\n//     // height: 8,\r\n//   },\r\n//   thumb: {\r\n//     // height: 24,\r\n//     // width: 24,\r\n//     backgroundColor: '#fff',\r\n//     border: '3px solid currentColor',\r\n//     // marginTop: -8,\r\n//     // marginLeft: -12,\r\n//     // '&:focus, &:hover, &$active': {\r\n//     //   boxShadow: 'inherit',\r\n//     // },\r\n//   },\r\n//   active: {},\r\n//   // valueLabel: {\r\n//   //   left: 'calc(-50% + 4px)',\r\n//   // },\r\n//   // track: {\r\n//   //   height: 8,\r\n//   //   borderRadius: 4,\r\n//   // },\r\n//   // rail: {\r\n//   //   height: 8,\r\n//   //   borderRadius: 4,\r\n//   // },\r\n// })(Slider);\r\n\r\nexport default function InputSlider({ steps, min, max, color, log, type, index, value, \r\n  sliderChangedCallback, sliderLogToggledCallback, disabled }) {\r\n  const classes = useStyles();\r\n  // const [value, setValue] = React.useState(typeof defaultValue === 'undefined' ? 0 : defaultValue);\r\n\r\n  // const [toggled, setToggled] = React.useState(false);\r\n\r\n  const sigDigits = 3;\r\n\r\n  const handleSliderChange = (event, newValue) => {\r\n    if (value !== newValue) {\r\n      // setValue(newValue);\r\n      let new_val = (log === true) ? Math.exp(newValue) : newValue;\r\n      sliderChangedCallback(type, index, roundToSignificantFigures(new_val, sigDigits));\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (event) => {\r\n    let newValue = event.target.value === '' ? 0 : Number(event.target.value);\r\n\r\n    if (value !== newValue) {\r\n      sliderChangedCallback(type, index, roundToSignificantFigures(newValue, sigDigits));\r\n      // setValue(newValue);\r\n    }\r\n  };\r\n\r\n\r\n  // const handleBlur = () => {\r\n  //   if (value < 0) {\r\n  //     setValue(0);\r\n  //   } else if (value > 100) {\r\n  //     setValue(100);\r\n  //   }\r\n  // };\r\n\r\n  value = typeof value === 'number' ? value : 0;\r\n  if (log)\r\n    min = (min <= 0) ? max * 1e-6 : min;  // make min value 6 orders of magnitude lower from maximum value \r\n\r\n  let linStep = (max - min) / steps;\r\n  let logStep = (Math.log(max) - Math.log(min)) / steps;\r\n\r\n  // calculates the linear step for input field\r\n  let inputStep = log ? Math.exp(Math.log(value) + logStep) - value : linStep;\r\n  inputStep = roundToSignificantFigures(inputStep, 3)\r\n  \r\n  // console.log(inputStep);\r\n\r\n  //   function valueLabelFormat(value) {\r\n  //     const [coefficient, exponent] = value\r\n  //       .toExponential()\r\n  //       .split('e')\r\n  //       .map((item) => Number(item));\r\n  //     return `${Math.round(coefficient)}e^${exponent}`;\r\n  //   }\r\n\r\n  return (\r\n    <div >\r\n      <Grid container spacing={2} alignItems=\"center\">\r\n        <Grid item xs>\r\n          <ToggleButton\r\n            // value='check'\r\n            selected={log}\r\n            disabled={disabled}\r\n            onChange={() => sliderLogToggledCallback(type, index)}\r\n          >Log</ToggleButton>\r\n        </Grid>\r\n        <Grid item xs>\r\n          <MySlider\r\n            value={log ? Math.log(value) : value}\r\n            onChange={handleSliderChange}\r\n            aria-labelledby=\"input-slider\"\r\n            min={log ? Math.log(min) : min}\r\n            max={log ? Math.log(max) : max}\r\n            step={log ? logStep : linStep}\r\n            //className={classes.root}\r\n            color={color}\r\n            disabled={disabled}\r\n          />\r\n        </Grid>\r\n        <Grid item>\r\n          <Input\r\n            value={value}\r\n            margin=\"dense\"\r\n            className={classes.input}\r\n            // multiline={true}\r\n            onChange={handleInputChange}\r\n            // onBlur={handleBlur}\r\n            inputProps={{\r\n                min:  min,\r\n                max:  max,\r\n                step: inputStep,\r\n              type: 'number',\r\n              'aria-labelledby': 'input-slider',\r\n            }}\r\n            disabled={disabled}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n    </div>\r\n  );\r\n\r\n  // return (\r\n  //   <div >\r\n  //     <Grid container spacing={2} alignItems=\"center\">\r\n  //       <Grid item xs>\r\n  //         {forwardRateSlider ? (\r\n  //         <BlueSlider\r\n  //           value={typeof value === 'number' ? value : 0}\r\n  //           onChange={handleSliderChange}\r\n  //           aria-labelledby=\"input-slider\"\r\n  //           min={typeof min === 'undefined' ? 0 : min}\r\n  //           max={typeof max === 'undefined' ? 100 : max}\r\n  //           step={typeof step === 'undefined' ? 1 : step}\r\n  //         />)\r\n  //         : (\r\n  //           <RedSlider\r\n  //           value={typeof value === 'number' ? value : 0}\r\n  //           onChange={handleSliderChange}\r\n  //           aria-labelledby=\"input-slider\"\r\n  //           min={typeof min === 'undefined' ? 0 : min}\r\n  //           max={typeof max === 'undefined' ? 100 : max}\r\n  //           step={typeof step === 'undefined' ? 1 : step}\r\n  //           disabled={disabled}\r\n  //         />\r\n  //         )}\r\n  //       </Grid>\r\n  //       <Grid item>\r\n  //         <Input\r\n  //           value={value}\r\n  //           margin=\"dense\"\r\n  //           // multiline={true}\r\n  //           onChange={handleInputChange}\r\n  //           onBlur={handleBlur}\r\n  //           inputProps={{\r\n  //               min: typeof min === 'undefined' ? 0 : min,\r\n  //               max: typeof max === 'undefined' ? 100 : max,\r\n  //               step: typeof step === 'undefined' ? 1 : step,\r\n  //             type: 'number',\r\n  //             'aria-labelledby': 'input-slider',\r\n  //           }}\r\n  //           disabled={disabled}\r\n  //         />\r\n  //       </Grid>\r\n  //     </Grid>\r\n  //   </div>\r\n  // );\r\n}\r\n\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport InputSlider from './Slider.js'\r\nimport './App.css';\r\n\r\nimport { InlineMath } from 'react-katex';\r\nimport 'katex/dist/katex.min.css';\r\n\r\n// const useStyles = makeStyles({\r\n//   table: {\r\n//     minWidth: 650,\r\n//   },\r\n// });\r\n\r\n// function createData(name, calories, fat, carbs, protein) {\r\n//   return { name, calories, fat, carbs, protein };\r\n// }\r\n\r\n// const rows = [\r\n//   createData('Frozen yoghurt', 159, 6.0, 24, 4.0),\r\n//   createData('Ice cream sandwich', 237, 9.0, 37, 4.3),\r\n//   createData('Eclair', 262, 16.0, 24, 6.0),\r\n//   createData('Cupcake', 305, 3.7, 67, 4.3),\r\n//   createData('Gingerbread', 356, 16.0, 49, 3.9),\r\n// ];\r\n\r\nexport default function InitCondTable( {data, sliderChangedCallback, sliderLogToggledCallback} ) {\r\n//   const classes = useStyles();\r\n\r\n  return (\r\n    <TableContainer component={Paper}>\r\n      <Table size=\"small\" aria-label=\"simple table\">\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell align=\"center\">Compartment</TableCell>\r\n            <TableCell align=\"center\">Initial conditions</TableCell>\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {data.map((entry, index) => (\r\n            <TableRow>\r\n              <TableCell align=\"center\"><InlineMath math={entry.texName} errorColor={'#cc0000'}/></TableCell>\r\n              <TableCell align=\"center\">\r\n                <InputSlider \r\n                  log={entry.log}\r\n                  steps={100} \r\n                  min={entry.min}\r\n                  max={entry.max} \r\n                  value={entry.init}\r\n                  type='init'\r\n                  index={index}\r\n                  color='primary'\r\n                  sliderChangedCallback={sliderChangedCallback}\r\n                  sliderLogToggledCallback={sliderLogToggledCallback}>\r\n                </InputSlider>\r\n              </TableCell>\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    </TableContainer>\r\n  );\r\n}\r\n\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport InputSlider from './Slider.js'\r\n\r\nimport { InlineMath } from 'react-katex';\r\nimport 'katex/dist/katex.min.css';\r\n\r\n\r\nexport default function RatesTable({data, disabled, sliderChangedCallback, sliderLogToggledCallback}) {\r\n    //   const classes = useStyles();\r\n  \r\n    return (\r\n      <TableContainer component={Paper}>\r\n        <Table size=\"small\" aria-label=\"simple table\">\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell align=\"center\">Rate constant</TableCell>\r\n              <TableCell align=\"center\">Forward rates</TableCell>\r\n              <TableCell align=\"center\">Backward rates</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n              {data.map((entry, index) => (\r\n                  <TableRow>\r\n                    <TableCell align=\"center\">\r\n                      <InlineMath math={entry.texName} errorColor={'#cc0000'}/>\r\n                    </TableCell>\r\n                      <TableCell align=\"center\">\r\n                        <InputSlider log={entry.log_fr} \r\n                          steps={100} \r\n                          min={entry.min_fr}\r\n                          max={entry.max_fr} \r\n                          value={entry.fr}\r\n                          type=\"fr\"\r\n                          index={index} \r\n                          sliderChangedCallback={sliderChangedCallback}\r\n                          sliderLogToggledCallback={sliderLogToggledCallback}\r\n                          color=\"primary\"\r\n                        />\r\n                      </TableCell>\r\n                      <TableCell align=\"center\">\r\n                        <InputSlider log={entry.log_br} \r\n                          steps={100} \r\n                          min={entry.min_br} \r\n                          max={entry.max_br} \r\n                          value={entry.br} \r\n                          type=\"br\"\r\n                          index={index} \r\n                          sliderChangedCallback={sliderChangedCallback}\r\n                          sliderLogToggledCallback={sliderLogToggledCallback}\r\n                          disabled={disabled}\r\n                          color=\"secondary\"\r\n                        />\r\n                      </TableCell>\r\n                  </TableRow>\r\n              ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    );\r\n}","import React from 'react';\r\nimport TextareaAutosize from '@material-ui/core/TextareaAutosize';\r\nimport { Button } from '@material-ui/core';\r\n\r\n\r\n// export default class TextArea extends React.Component {\r\n\r\n//     constructor(props) {\r\n//         super(props);\r\n//         this.state = {\r\n//             text: typeof props.text === 'undefined' ? \"\" : props.text\r\n//         }\r\n//         // this.callBack = props.modelSubmitCallback;\r\n//         this.handleChange = this.handleChange.bind(this);\r\n//     }\r\n\r\n//     handleChange (event) {\r\n//         this.setState(state => ({text: event.target.value}));\r\n//     };\r\n\r\n//     render() {\r\n//         return (\r\n//             <div>\r\n//                 <TextareaAutosize onChange={this.handleChange} aria-label=\"empty textarea\" placeholder=\"Model...\" value={this.state.text}></TextareaAutosize>\r\n//                 <br/>\r\n//                 <Button variant=\"contained\" \r\n//                     onClick={() => this.props.modelSubmitCallback(this.state.text)} \r\n//                     color=\"primary\">Submit</Button>\r\n//             </div>\r\n//         );\r\n//     }\r\n// }\r\n\r\n\r\nexport default function TextArea({schemeText, modelSubmitCallback, textChangedCallback}) {\r\n    // const [text, setValue] = React.useState(typeof props.schemeText === 'undefined' ? \"\" : props.schemeText);\r\n  \r\n    return (\r\n        <div>\r\n          <div className=\"text-area\">\r\n            <TextareaAutosize \r\n              onChange={event => textChangedCallback(event.target.value)} \r\n              aria-label=\"empty textarea\" \r\n              placeholder=\">> Place kinetic model here <<\"\r\n              style={{fontSize: 18, fontFamily: 'Palatino'}}\r\n              value={schemeText}>\r\n            </TextareaAutosize>\r\n            </div>\r\n            <Button variant=\"contained\" \r\n                onClick={() => modelSubmitCallback()} \r\n                color=\"primary\">Submit</Button>\r\n        </div>\r\n    );\r\n  }\r\n","// from https://github.com/giannotr/runge-kutta-js, modified\r\n\r\n// \"use strict\";\r\n// var __assign = (this && this.__assign) || function () {\r\n//     __assign = Object.assign || function(t) {\r\n//         for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n//             s = arguments[i];\r\n//             for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n//                 t[p] = s[p];\r\n//         }\r\n//         return t;\r\n//     };\r\n//     return __assign.apply(this, arguments);\r\n// };\r\n\r\n// var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n//     for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n//     for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n//         for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n//             r[k] = a[j];\r\n//     return r;\r\n// };\r\n\r\n// Object.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction _scalarMult (scalar, vector, n) {\r\n    /*\r\n    * Creates a new array.\r\n    */\r\n    var res = new Array(n);\r\n    for (let i = 0; i < n; i++){\r\n        res[i] = vector[i] * scalar;\r\n    }\r\n    return res; \r\n}\r\n\r\nfunction _vecAdd2Sec (a, b, n) { \r\n    /*\r\n    * Adds a to second array (b) and returns it !!!!! \r\n    */\r\n    for (let i = 0; i < n; i++){\r\n        b[i] += a[i];\r\n    }\r\n    return b; \r\n}\r\n\r\n\r\nlet UndependentVariableError = new Error('The destination of the undependent variable has to be greater than its start');\r\n// let StepSizeDivisibilityError = new Error('The range has to be an divisible by the step size');\r\n\r\nexport function rungeKutta4(ODE, initialCondition, range=[0, 1], steps=500) {\r\n    var t0 = range[0], t1 = range[1];\r\n\r\n    if (t1 <= t0)\r\n        throw UndependentVariableError;\r\n\r\n    var stepSize = (t1 - t0) / steps;\r\n\r\n    return initialCondition.length > 1 ? \r\n        rk4Multi(ODE, steps, stepSize, initialCondition, t0) : \r\n        rk4Single(ODE, steps, stepSize, initialCondition, t0);\r\n\r\n    // if (stepSize === void 0) { stepSize = 1; }\r\n    // var _return;\r\n    //     var steps = Math.round((t1 - t0) / stepSize);\r\n    //     // var args = {\r\n    //     //     equation: ODE,\r\n    //     //     start: t0,\r\n    //     //     stepSize: stepSize,\r\n    //     //     steps: steps,\r\n    //     // };\r\n    //     // if (Number.isInteger(steps)) {\r\n    //     if (typeof initialCondition === 'object' && initialCondition.length > 1) {\r\n    //         // _return = rk4Multi(__assign(__assign({}, args), { initialCondition: initialCondition }));\r\n    //         _return = rk4Multi(ODE, steps, stepSize, initialCondition, t0);\r\n\r\n    //     }\r\n    //     else {\r\n    //         var _initialCondition = void 0;\r\n    //         if (typeof initialCondition === 'object') {\r\n    //             _initialCondition = initialCondition[0];\r\n    //         }\r\n    //         else {\r\n    //             _initialCondition = initialCondition;\r\n    //         }\r\n    //         _return = rk4Single(__assign(__assign({}, args), { initialCondition: _initialCondition }));\r\n    //     }\r\n    //     return _return;\r\n    //     // }\r\n    //     // throw StepSizeDivisibilityError;\r\n    // }\r\n    // throw UndependentVariableError;\r\n}\r\n\r\nfunction rk4Single (f, n, h, j, t_start) {\r\n    /*\r\n    * f - function to call\r\n    * n - number of steps\r\n    * h - step size\r\n    * j - initial condition - must be number\r\n    * t_start = time at initial conditions\r\n     */\r\n    var t = t_start;\r\n    var x = new Array(n+1);  // x values\r\n    var y = new Array(n+1)   // y values\r\n    x[0] = t; // t start\r\n    y[0] = j;\r\n    var i = 0;\r\n    var k1, k2, k3, k4;\r\n    while (i < n) {\r\n        k1 = f(t, y[i]);\r\n        k2 = f(t + (.5 * h), y[i] + (.5 * h * k1));\r\n        k3 = f(t + (.5 * h), y[i] + (.5 * h * k2));\r\n        k4 = f(t + h, y[i] + (h * k3));\r\n        y[i + 1] = y[i] + (h * (k1 + (2 * k2) + (2 * k3) + k4) / 6);\r\n        t += h;\r\n        i++;\r\n        x[i] = t;\r\n    }\r\n    return {xVals: x, yVals: y};\r\n}\r\n\r\n\r\nfunction rk4Multi(f, n, h, j, t_start) {\r\n    /*\r\n    * f - function to call\r\n    * n - number of steps\r\n    * h - step size\r\n    * j - initial condition vector\r\n    * t_start = time at initial conditions\r\n    */\r\n    var m = j.length;\r\n    var t = t_start;\r\n    var k1, k2, k3, k4;\r\n    var yLast = j;\r\n\r\n    var x = new Array(n+1);  // x values\r\n    x[0] = t; // t start\r\n\r\n    var result = new Array(m);\r\n    for (let k = 0; k < m; k++) {\r\n        result[k] = new Array(n+1); // n + 1 points\r\n        result[k][0] = yLast[k];\r\n    }\r\n    for (let i = 1; i <= n; i++) {\r\n        k1 = f(t, yLast);\r\n        k2 = f(t + (.5 * h), _vecAdd2Sec(yLast, _scalarMult(.5 * h, k1, m), m));\r\n        k3 = f(t + (.5 * h), _vecAdd2Sec(yLast, _scalarMult(.5 * h, k2, m), m));\r\n        k4 = f(t + h, _vecAdd2Sec(yLast, _scalarMult(h, k3, m), m));\r\n        for (let k = 0; k < m; k++) {\r\n            yLast[k] += h * (k1[k] + (2 * k2[k]) + (2 * k3[k]) + k4[k]) / 6;\r\n            result[k][i] = yLast[k];\r\n        }\r\n        t += h;\r\n        x[i] = t;\r\n    }\r\n\r\n    return {xVals: x, yVals: result};\r\n}","\r\nimport { rungeKutta4 } from './rk.js';\r\nvar rk45 = require( \"./rk45.js\" );\r\n\r\n// Warn if overriding existing method\r\nif(Array.prototype.equals)\r\n    console.warn(\"Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code.\");\r\n\r\n// attach the .equals method to Array's prototype to call it on any array\r\nArray.prototype.equals = function (array) {\r\n    // if the other array is a falsy value, return\r\n    if (!array)\r\n        return false;\r\n\r\n    // compare lengths - can save a lot of time \r\n    if (this.length !== array.length)\r\n        return false;\r\n\r\n    for (var i = 0, l=this.length; i < l; i++) {\r\n        // Check if we have nested arrays\r\n        if (this[i] instanceof Array && array[i] instanceof Array) {\r\n            // recurse into the nested arrays\r\n            if (!this[i].equals(array[i]))\r\n                return false;       \r\n        }           \r\n        else if (this[i] !== array[i]) { \r\n            // Warning - two different object instances will never be equal: {x:20} != {x:20}\r\n            return false;   \r\n        }           \r\n    }       \r\n    return true;\r\n}\r\n// Hide method from for-in loops\r\nObject.defineProperty(Array.prototype, \"equals\", {enumerable: false});\r\n\r\nexport class GeneralModel {\r\n\r\n    constructor () {\r\n        this.initial_conditions = {};\r\n        this.elem_reactions = [];  // list of dictionaries of elementary reactions\r\n        this.scheme = \"\";\r\n        this.func = null;  // function that returns dc_dt for current c and t for built model\r\n        this.diffEquations = '';  //variable that stores diff. equation text to be displayed\r\n        this.diffEquationsFRates = '';  //only forward rates diff eqs.\r\n        this.latexModel = '';  // model rewritten in latex forward and backward rates\r\n        this.latexModelFRates = '';  // model rewritten in latex only forward rates\r\n    }\r\n\r\n    addElementaryReaction(from_comp=['A', 'A'], to_comp=['B', 'C'], forward_rate=1, backward_rate=0, comment='') {\r\n        let reaction = {\r\n            from_comp: from_comp,\r\n            to_comp: to_comp,\r\n            forward_rate: forward_rate,\r\n            backward_rate: backward_rate,\r\n            comment: comment\r\n        };\r\n\r\n        for (let i = 0; i < this.elem_reactions.length; i++) {\r\n            let el = this.elem_reactions[i];\r\n            if (el.from_comp.equals(reaction.from_comp) && el.to_comp.equals(reaction.to_comp)) {\r\n                el.forward_rate = reaction.forward_rate;\r\n                el.backward_rate = reaction.backward_rate;\r\n                return;\r\n            }\r\n        }\r\n\r\n        this.elem_reactions.push(reaction);\r\n    }\r\n\r\n    getCompartments() {\r\n        let names = [];\r\n\r\n        this.elem_reactions.forEach(el => {\r\n            el.from_comp.forEach(comp => {\r\n                if (!(names.includes(comp))) names.push(comp);\r\n            });\r\n            el.to_comp.forEach(comp => {\r\n                if (!(names.includes(comp))) names.push(comp);\r\n            });\r\n        });\r\n\r\n        return names;\r\n    }\r\n\r\n    getLatexFormattedCompartments() {\r\n        let result = [];\r\n\r\n        for (let c of this.getCompartments()) {\r\n            // following code makes numbers subscript and text keeps normal, all text is then \r\n            // enclosed in \\\\mathrm{}, also dots . are replaced by \\\\cdot\r\n\r\n            // let chars = c.split('');\r\n            // let name = '';\r\n            // let numbers = null;\r\n\r\n            // let addNumbers = function () {\r\n            //     if (numbers == null) return;\r\n\r\n            //     name += `_{${numbers}}`;\r\n            //     numbers = null;\r\n            // }\r\n\r\n            // for (let i = 0; i < chars.length; i++) {\r\n            //     if (isNaN(chars[i])) {\r\n            //         addNumbers();\r\n            //         name += chars[i];\r\n            //     }\r\n            //     else {\r\n            //         numbers = numbers == null ? '' : numbers;\r\n            //         numbers += chars[i];\r\n            //         if (i === chars.length - 1)\r\n            //             addNumbers();\r\n            //     }\r\n            // }\r\n\r\n            // name = `\\\\mathrm{${c.replaceAll('.', '\\\\cdot ')}}`;\r\n            \r\n            result.push(`\\\\mathrm{${c.replaceAll('.', '{\\\\Large\\\\cdot}')}}`);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // getRateNames(backwardRates=false) {\r\n\r\n    //     let comps = this.getCompartments();\r\n    //     let fComps = this.getLatexFormattedCompartments();\r\n    //     let dict = {};\r\n\r\n    //     for (let i = 0; i < comps.length + 1; i++) \r\n    //         dict[comps[i]] = fComps[i];\r\n\r\n    //     let rateNames = [];\r\n    //     for (let el of this.elem_reactions) {\r\n    //         let fFromComps = el.from_comp.map(c => dict[c]);\r\n    //         let fToComps = el.to_comp.map(c => dict[c]);\r\n\r\n    //         let occursFC = GeneralModel.occurences(fFromComps);\r\n    //         let occursTC = GeneralModel.occurences(fToComps);\r\n\r\n    //         fFromComps = [];\r\n    //         fToComps = [];\r\n\r\n    //         // if there is multiple compartments, find occurences and multiply them\r\n    //         for (let key in occursFC) {\r\n    //             let num = occursFC[key];\r\n    //             fFromComps.push(num === 1 ? key : `${num}${key}`);\r\n    //         }\r\n\r\n    //         for (let key in occursTC) {\r\n    //             let num = occursTC[key];\r\n    //             fToComps.push(num === 1 ? key : `${num}${key}`);\r\n    //         }\r\n\r\n    //         let fArrow = backwardRates ? '\\\\rightarrow' : '\\\\rightleftharpoons';\r\n    //         let frNoColor = `k_{${fFromComps.join('+')} ${fArrow} ${fToComps.join('+')}}`;\r\n\r\n    //         let fr = `{\\\\color{blue}${frNoColor}}`;\r\n    //         let br = `{\\\\color{red}k_{${fFromComps.join('+')} \\\\leftarrow ${fToComps.join('+')}}}`;\r\n\r\n    //         rateNames.push(backwardRates ? [fr, br] : frNoColor);\r\n    //     }\r\n\r\n    //     return rateNames;\r\n    // }\r\n\r\n    getRateNames(backwardRates=false, noColor=false) {\r\n\r\n        let rateNames = [];\r\n        for (let i = 0; i < this.elem_reactions.length; i++) {\r\n            // let frNoColor = `k_{${i+1}}`;\r\n            let fr = noColor ? `k_{${i+1}}` : `{\\\\color{blue}k_{${i+1}}}`;\r\n            let br = noColor ? `k_{-${i+1}}`: `{\\\\color{red}k_{-${i+1}}}`;\r\n\r\n            rateNames.push(backwardRates ? [fr, br] : fr);\r\n        }\r\n\r\n        return rateNames;\r\n    }\r\n\r\n    _buildLatexModel(backwardRates=false) {\r\n        let comps = this.getCompartments();\r\n        let fComps = this.getLatexFormattedCompartments();\r\n        let dict = {};\r\n        let rateNames = this.getRateNames(backwardRates);\r\n\r\n        for (let i = 0; i < comps.length + 1; i++) \r\n            dict[comps[i]] = fComps[i];\r\n\r\n        let eqs = [];\r\n        for (let i = 0; i < this.elem_reactions.length; i++) {\r\n            let el = this.elem_reactions[i];\r\n            let fFromComps = el.from_comp.map(c => dict[c]);\r\n            let fToComps = el.to_comp.map(c => dict[c]);\r\n\r\n            let occursFC = GeneralModel.occurences(fFromComps);\r\n            let occursTC = GeneralModel.occurences(fToComps);\r\n\r\n            fFromComps = [];\r\n            fToComps = [];\r\n\r\n            // if there is multiple compartments, find occurences and multiply them\r\n            for (let key in occursFC) {\r\n                let num = occursFC[key];\r\n                fFromComps.push(num === 1 ? key : `${num}\\\\ ${key}`);\r\n            }\r\n\r\n            for (let key in occursTC) {\r\n                let num = occursTC[key];\r\n                fToComps.push(num === 1 ? key : `${num}\\\\ ${key}`);\r\n            }\r\n\r\n            let fArrowFW = `&\\\\xrightleftharpoons[${rateNames[i][1]}]{\\\\hspace{0.1cm}${rateNames[i][0]}\\\\hspace{0.1cm}}`;\r\n            let fArrowF = `&\\\\xrightarrow{\\\\hspace{0.1cm}${rateNames[i]}\\\\hspace{0.1cm}}`;\r\n            // help from https://tex.stackexchange.com/questions/47687/adding-line-by-line-comments-to-math-proofs\r\n            let comment = (el.comment === '') ? '' : `&& {\\\\color{green}\\\\text{\\\\textit{${el.comment}}}}`;\r\n            let eq = `${fFromComps.join('+')}  ${backwardRates ? fArrowFW : fArrowF} ${fToComps.join('+')} ${comment}`;\r\n\r\n            eqs.push(eq);\r\n        }\r\n\r\n        let finalModel = `\\\\begin{aligned} ${eqs.join('\\\\\\\\')} \\\\end{aligned}`;\r\n        // console.log(finalModel);\r\n        return finalModel;\r\n        // return eqs.join('\\\\\\\\');\r\n    }\r\n\r\n\r\n    printModel() {\r\n        console.log(`Scheme: ${this.scheme}`);\r\n        console.log(\"Initial conditions:\", this.initial_conditions);\r\n\r\n        this.elem_reactions.forEach(el => {\r\n            console.log(`Elementary reaction: ${el.from_comp.join(' + ')} -> ${el.to_comp.join(' + ')}, forward_rate=${el.forward_rate}, backward_rate=${el.backward_rate}`);\r\n        });\r\n    }\r\n\r\n    simulateModel(steps=500, range=[0, 100], useZeroBR=false) {\r\n        let j = Object.values(this.initial_conditions);   \r\n\r\n        let forward_rates = new Array(this.elem_reactions.length);\r\n        let backward_rates = new Array(this.elem_reactions.length);\r\n\r\n        for (let i = 0; i < this.elem_reactions.length; i++) {\r\n            forward_rates[i] = this.elem_reactions[i].forward_rate;\r\n            backward_rates[i] = useZeroBR ? 0 : this.elem_reactions[i].backward_rate;\r\n        }\r\n\r\n        // let solution = rungeKutta4((t, c) => this.func(t, c, forward_rates, backward_rates), j, range, steps);\r\n\r\n        var solver = new rk45.System();\r\n\r\n        solver.setStart( range[0] );        // Initial start time, t=0.\r\n        solver.setStop( range[1] );         // Time at which we want a solution, t=2.\r\n        solver.setInitX( j );  // y(0) -- value of y when t=0.\r\n        solver.setH(0.1);\r\n        solver.setFn( (t, c) => this.func(t, c, forward_rates, backward_rates) );    // Differential equation we're solving.\r\n        \r\n        solver.solve();\r\n        // console.log(`Number of steps: ${solver.result.xVals.length}`);\r\n\r\n        return solver.result;\r\n    }\r\n\r\n    static occurences(array, dict=null, subtractOccurences=false) {\r\n        /*\r\n        * Makes a dictionary of unique values in array and ascribes them a number of times they occured.\r\n        * If dict is not null, it uses this dictionary as a starting point.\r\n        * If subtractOccurences=true, if value exists already in dict, it will decresed by one. If not, \r\n        * it starts at -1.\r\n        */\r\n        dict = dict === null ? {} : dict;\r\n\r\n        let num = subtractOccurences ? -1 : 1;\r\n\r\n        for (var i = 0; i < array.length; i++) {\r\n            var value = array[i];\r\n            dict[value] = dict[value] ? dict[value] + num : num;\r\n        }\r\n        return dict;\r\n    }\r\n\r\n\r\n    _buildDiffEq(idx_from, idx_to, includeBackwardRates=true){\r\n        // builds latex type diff. equation for printing\r\n\r\n        let rateNames = this.getRateNames(true);\r\n        let compsF = this.getLatexFormattedCompartments();\r\n        let comps_len = compsF.length;\r\n\r\n        let posTerms = new Array(comps_len);\r\n        let negTerms = new Array(comps_len);\r\n        for (let i = 0; i < comps_len; i++) {\r\n            posTerms[i] = [];\r\n            negTerms[i] = [];\r\n        }\r\n\r\n        // build latex diff. equations\r\n        for (let i = 0; i < this.elem_reactions.length; i++) {\r\n            \r\n            let forward_prod = rateNames[i][0];\r\n            let backward_prod = rateNames[i][1];\r\n\r\n            let fList = idx_from[i].map(k => `[${compsF[k]}]`);\r\n            let bList = idx_to[i].map(k => `[${compsF[k]}]`);\r\n\r\n            let occursF = GeneralModel.occurences(fList);\r\n            let occursB = GeneralModel.occurences(bList);\r\n\r\n            for (let key in occursF) {\r\n                let num = occursF[key];\r\n                forward_prod += num === 1 ? key : `${key}^{${num}}`;\r\n            }\r\n\r\n            for (let key in occursB) {\r\n                let num = occursB[key];\r\n                backward_prod += num === 1 ? key : `${key}^{${num}}`;\r\n            }\r\n\r\n            idx_from[i].forEach(k => {\r\n                if (includeBackwardRates)\r\n                    posTerms[k].push(backward_prod);\r\n\r\n                negTerms[k].push(forward_prod);\r\n            });\r\n\r\n            idx_to[i].forEach(k => {\r\n                posTerms[k].push(forward_prod);\r\n\r\n                if (includeBackwardRates)\r\n                    negTerms[k].push(backward_prod);\r\n            });\r\n        }\r\n\r\n        // finish latex diff. equations\r\n\r\n        // var result = '';\r\n        let eqs = [];\r\n        for (let i = 0; i < comps_len; i++) {\r\n            let posOccurs = GeneralModel.occurences(posTerms[i]);\r\n            let allOccurs = GeneralModel.occurences(negTerms[i], posOccurs, true); // subtract same occurences\r\n\r\n            let terms = [];\r\n            for (let key in allOccurs) {\r\n                let num = allOccurs[key];\r\n                if (num === 0)\r\n                    continue;\r\n\r\n                let sign = num > 0 ? '+' : '-';\r\n                let numStr = Math.abs(num) === 1 ? '' : Math.abs(num);\r\n                terms.push(`${sign}${numStr}${key}`);\r\n            }\r\n\r\n            eqs.push(`\\\\frac{\\\\mathrm d[${compsF[i]}]}{\\\\mathrm dt}&=${terms.join('')}`);\r\n        }\r\n\r\n        return `\\\\begin{aligned} ${eqs.join('\\\\\\\\')} \\\\end{aligned}`;;\r\n    }\r\n\r\n    buildFunc() {\r\n        let comps = this.getCompartments();\r\n        var comps_len = comps.length;\r\n\r\n        let inv_dict = {};\r\n        for (let i = 0; i < comps_len; i++)\r\n            inv_dict[comps[i]] = i;\r\n            \r\n        var r = this.elem_reactions.length;\r\n        var idx_from = [];  // arrays of arrays of indexes for each elementary reaction\r\n        var idx_to = [];  // arrays of arrays of indexes for each elementary reaction\r\n        var _forward_rates = [];\r\n        var _backward_rates = [];\r\n\r\n        for (let i = 0; i < r; i++) {\r\n            let el = this.elem_reactions[i];\r\n            \r\n            let i_from = el.from_comp.map(comp => inv_dict[comp]); // list of indexes of starting materials\r\n            let i_to = el.to_comp.map(comp => inv_dict[comp]);  // list of indexes of reaction products\r\n\r\n            idx_from.push(i_from);\r\n            idx_to.push(i_to);\r\n\r\n            _forward_rates[i] = el.forward_rate;\r\n            _backward_rates[i] = el.backward_rate;\r\n        }\r\n\r\n        this.diffEquations = this._buildDiffEq(idx_from, idx_to, true);\r\n        this.diffEquationsFRates = this._buildDiffEq(idx_from, idx_to, false);\r\n        this.latexModel = this._buildLatexModel(true);\r\n        this.latexModelFRates = this._buildLatexModel(false);\r\n\r\n\r\n        this.func = (t, c, forward_rates=null, backward_rates=null) => {\r\n            if (forward_rates == null)\r\n                forward_rates = _forward_rates;\r\n            if (backward_rates == null)\r\n                backward_rates = _backward_rates;\r\n\r\n            let dc_dt = new Array(comps_len).fill(0);\r\n\r\n            for (let i = 0; i < r; i++) {\r\n\r\n                let forward_prod = forward_rates[i];\r\n                let backward_prod = backward_rates[i];\r\n                \r\n                for (let k = 0; k < idx_from[i].length; k++) {\r\n                    forward_prod *= c[idx_from[i][k]];\r\n                }\r\n\r\n                for (let k = 0; k < idx_to[i].length; k++) {\r\n                    backward_prod *= c[idx_to[i][k]];\r\n                }\r\n\r\n                for (let k = 0; k < idx_from[i].length; k++) {\r\n                    dc_dt[idx_from[i][k]] += backward_prod - forward_prod; // reactants\r\n                }\r\n\r\n                for (let k = 0; k < idx_to[i].length; k++) {\r\n                    dc_dt[idx_to[i][k]] += forward_prod - backward_prod; // products\r\n                }\r\n            }\r\n            return dc_dt;\r\n        };\r\n    }\r\n\r\n    static fromText(scheme) {\r\n        var _model = new GeneralModel();\r\n        _model.scheme = scheme;\r\n\r\n        let lines = scheme.split('\\n');\r\n\r\n        // debugger;\r\n\r\n\r\n        // + sign for separation of reactants cannot follow '_' and '^' characters and cannot be enclosed in curly braces\r\n\r\n        lines.forEach(line => {\r\n            let split = line.split('//')  // remove comments\r\n            line = split[0];\r\n            let comment = split.length == 2 ? split[1] : '';\r\n            comment = comment.trim();\r\n            // console.log(comment);\r\n            let white_space_filter = line.match(/[^\\s]+/g);\r\n            if (line === \"\" || white_space_filter === null)\r\n                return;\r\n\r\n            line = white_space_filter.join('')  // remove white space characters\r\n            let sides = [];\r\n\r\n            line.split('=').forEach(side => {\r\n                let tokens = [];\r\n                \r\n                // find the indicies of + signs\r\n                var plusIndices = [];\r\n                for(var i = 0; i < side.length; i++) {\r\n                    if (side[i] === \"+\" && side[i - 1] !== '^' && side[i - 1] !== '_') {\r\n                        plusIndices.push(i);\r\n                    } \r\n                }\r\n\r\n                var re = /{[^{}]*\\+[^{}]*}/g;  // find the + signs enclosed in curly braces\r\n                var s = `${side}`; // copy is needed, otherwise next code will cause infinite loop... IDK why\r\n                \r\n                var m;\r\n                while(m = re.exec(s)) {\r\n                    var deleted = true;\r\n                    let startIdx = m.index;\r\n                    let endIdx = startIdx + m[0].length - 1;\r\n                    while(deleted) {\r\n                        deleted = false;\r\n                        for (var i = 0; i <= plusIndices.length; i++){\r\n                            if (plusIndices[i] > startIdx && plusIndices[i] < endIdx) {\r\n                                plusIndices.splice(i, 1);\r\n                                deleted = true;\r\n                                break;                                \r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                // console.log(plusIndices);\r\n\r\n                // split the side based on found indexes\r\n                let splitSide = [];\r\n                var lastIdx = 0;\r\n                for (var i = 0; i < plusIndices.length; i++){\r\n                    splitSide.push(side.substring(lastIdx, plusIndices[i]));\r\n                    lastIdx = plusIndices[i] + 1;\r\n                }\r\n                splitSide.push(side.substring(lastIdx, side.length));\r\n\r\n                splitSide.forEach(token => {\r\n\r\n                    // let regExp = /(\\d)([\\w\\d\\.]+)|([\\w\\d\\.]+)/g;\r\n                    let regExp = /^(\\d+).+/g;  // match multiple digits at followed by any number of characters, digits has to be at the begining of the string\r\n\r\n                    let match = regExp.exec(token);  // get groups\r\n\r\n                    // let notContainsNum = typeof match[1] == 'undefined';\r\n                    let containsNum = match != null;\r\n\r\n                    let number = containsNum ? parseInt(match[1]) : 1;\r\n                    let name = containsNum ? token.substring(match[1].length) : token;\r\n\r\n                    // if (number < 1) number = 1;\r\n                    \r\n                    for (let i = 0; i < number; i++) \r\n                        tokens.push(name);\r\n                });\r\n                sides.push(tokens);\r\n            });\r\n\r\n            for (let i = 0; i < sides.length - 1; i++) {\r\n                _model.addElementaryReaction(sides[i], sides[i+1], 1, 0, comment);\r\n            }\r\n\r\n        });\r\n\r\n        let comps = _model.getCompartments();\r\n        for (let i = 0; i < comps.length; i++)\r\n            _model.initial_conditions[comps[i]] = i === 0 ? 1 : 0;\r\n\r\n        return _model;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n","\r\n\r\n\r\n\r\n\r\nexport const kineticModels = [\r\n    {\r\n        class: \"Funny models\",\r\n        name: \"Cyclic model\",\r\n        description: \"\",\r\n        scheme: \"A = B = C = D = E = F = G = H = I = J = K = A\",\r\n        nonZeroBackwardRates: false,\r\n        initialConditions: {\r\n            A: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 1\r\n            },\r\n            B: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            C: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            D: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            E: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            F: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            G: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            H: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            I: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            J: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            K: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n        },\r\n    },\r\n    {\r\n        class: \"Funny models\",\r\n        name: \"Lotka-Volterra\",\r\n        description: \"\",\r\n        scheme: \"Rabbit = 2Rabbit\\nWolf = DeadWolf\\nWolf + Rabbit = 2Wolf\",\r\n        nonZeroBackwardRates: false,\r\n        initialConditions: {\r\n            Rabbit: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 1\r\n            },\r\n            Wolf: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 1\r\n            },\r\n            DeadWolf: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            }\r\n        },\r\n        rates: [\r\n            {\r\n                forwardRate: 4.4,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1.9,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1.3,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        class: \"Epidemic\",\r\n        name: \"SIR Model\",\r\n        description: \"TODO\",\r\n        scheme: \"Susceptible + Infected = 2Infected\\nInfected = Recovered\\nInfected = Dead\",\r\n        nonZeroBackwardRates: false,\r\n        initialConditions: {\r\n            Susceptible: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 100,\r\n                value: 10\r\n            },\r\n            Infected: {\r\n                logSlider: true,\r\n                min: 1e-5,\r\n                max: 10,\r\n                value: 1e-3\r\n            },\r\n            Recovered: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 10,\r\n                value: 0\r\n            },\r\n            Dead: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 10,\r\n                value: 0\r\n            }\r\n        },\r\n        rates: [\r\n            {\r\n                forwardRate: 0.6,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1.5,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.1,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        class: \"Epidemic\",\r\n        name: \"SEIRS Model\",\r\n        description: \"TODO\",\r\n        scheme: \"Susceptible + Infected = Exposed + Infected\\nExposed = Infected = Recovered = Susceptible\\nInfected = Dead\",\r\n        nonZeroBackwardRates: false,\r\n        initialConditions: {\r\n            Susceptible: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 100,\r\n                value: 10\r\n            },\r\n            Exposed: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 100,\r\n                value: 0\r\n            },\r\n            Infected: {\r\n                logSlider: true,\r\n                min: 1e-5,\r\n                max: 10,\r\n                value: 1e-4\r\n            },\r\n            Recovered: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 10,\r\n                value: 0\r\n            },\r\n            Dead: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 10,\r\n                value: 0\r\n            }\r\n        },\r\n        rates: [\r\n            {\r\n                forwardRate: 4,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.8,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 2.4,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.3,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.1,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        class: \"Chemical kinetics\",\r\n        name: \"Michaelis-Menten\",\r\n        description: \"TODO\",\r\n        scheme: \"E + S = ES = E + P\",\r\n        nonZeroBackwardRates: true,\r\n        initialConditions: {\r\n            E: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 3.5\r\n            },\r\n            S: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 10\r\n            },\r\n            ES: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            P: {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            }\r\n        },\r\n        rates: [\r\n            {\r\n                forwardRate: 0.4,\r\n                backwardRate: 1.4,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1.9,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        class: \"Chemical kinetics\",\r\n        name: \"H2 + Br2\",\r\n        description: \"TODO\",\r\n        scheme: \"Br2 = 2Br.\\nBr. + H2 = HBr + H.\\nH. + Br2 = HBr + Br.\",\r\n        nonZeroBackwardRates: true,\r\n        initialConditions: {\r\n            'Br2': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 1\r\n            },\r\n            'Br.': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            'H2': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 1\r\n            },\r\n            'HBr': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            'H.': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            }\r\n        },\r\n        rates: [\r\n            {\r\n                forwardRate: 0.4,\r\n                backwardRate: 0.9,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 2.9,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1.2,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        class: \"Photochemistry\",\r\n        name: \"Photosensitization\",\r\n        description: \"TODO\",\r\n        scheme: \"^3PS = PS // Triplet state decay of sensitizer\\n2^3PS = ^3PS + PS // Triplet-triplet annihilation\\nS + ^3PS = ^3S + PS // Energy transfer to substrate\\n^3S = S // Triplet state decay of substrate\\n2^3S = ^3S + S // Triplet-triplet annihilation\",\r\n        nonZeroBackwardRates: false,\r\n        initialConditions: {\r\n            '^3PS': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 1\r\n            },\r\n            'PS': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            'S': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 2\r\n            },\r\n            '^3S': {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            }\r\n        },\r\n        rates: [\r\n            {\r\n                forwardRate: 0.5,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.3,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.5,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.1,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        class: \"Photochemistry\",\r\n        name: \"Rose bengal kinetics\",\r\n        description: \"TODO\",\r\n        scheme: \"^1RB^{2-*} = ^3RB^{2-*} // Intersystem crossing\\n^1RB^{2-*} = RB^{2-} // Singlet state decay (internal conversion and fluorescence)\\n^3RB^{2-*} = RB^{2-} // Triplet state decay (internal conversion and phosphorescence)\\n^3RB^{2-*} + RB^{2-} = 2RB^{2-} // Self-quenching\\n2^3RB^{2-*} = ^1RB^{2-*} + RB^{2-} // Triplet-triplet annihilation\\n^3RB^{2-*} + RB^{2-} = RB^{.-} + RB^{.3-} // Electron transfer\\n2^3RB^{2-*} = RB^{.-} + RB^{.3-} // Disproportionation\\nRB^{.-} + RB^{.3-} = 2RB^{2-} // Back electron transfer\",\r\n        nonZeroBackwardRates: false,\r\n        initialConditions: {\r\n            \"^1RB^{2-*}\": {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 1\r\n            },\r\n            \"^3RB^{2-*}\": {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            \"RB^{2-}\": {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            \"RB^{.-}\": {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            },\r\n            \"RB^{.3-}\": {\r\n                logSlider: false,\r\n                min: 0,\r\n                max: 50,\r\n                value: 0\r\n            }\r\n        },\r\n        rates: [\r\n            {\r\n                forwardRate: 10,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 2,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1.01,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.6,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 1.2,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 0.2,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 2.4,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n            {\r\n                forwardRate: 4.5,\r\n                backwardRate: 0,\r\n                forwardRateMin: 0,\r\n                forwardRateMax: 10,\r\n                backwardRateMin: 0,\r\n                backwardRateMax: 10,\r\n                forwardRateLogSlider: false,\r\n                backwardRateLogSlider: false\r\n            },\r\n        ],\r\n    },\r\n]\r\n","import { useState, React } from 'react';\r\nimport Plot from 'react-plotly.js';\r\n\r\n\r\n// var layout = {\r\n//     title: 'Title of the graph',\r\n//     xaxis: {\r\n//         title: 'Time',\r\n//         showgrid: true,\r\n//         zeroline: false,\r\n//         linecolor: 'black',\r\n//         linewidth: 1,\r\n//         mirror: true\r\n//     },\r\n//     yaxis: {\r\n//         title: 'Concentration',\r\n//         showgrid: true,\r\n//         zeroline: false,\r\n//         type: 'log',\r\n//         linecolor: 'red',\r\n//         linewidth: 1,\r\n//         mirror: true\r\n//     }\r\n// };\r\n\r\nexport default function PlotlyGraph( {data, layout, config, frames, revision }) {\r\n    return (\r\n      <Plot\r\n        data={data}\r\n        layout={ layout }\r\n        config={config}\r\n        frames={frames}\r\n        // onUpdate={figure => console.log('on update')}\r\n        revision={revision}\r\n        useResizeHandler={true}\r\n        style={{\r\n          width: '100%',\r\n          height: '100%'\r\n        }}\r\n      />\r\n    );\r\n}\r\n\r\n/*export default function PlotlyGraph(props) {\r\n\r\n  // const [data, setData] = React.useState(props.graphData);\r\n  // const [frames, setFrames] = React.useState([]);\r\n  // const [layout, setLayout] = React.useState(layout);\r\n  // const [config, setConfig] = React.useState({scrollZoom: true, responsive: false});\r\n\r\n  const [figure, setFigure] = useState({\r\n    data: [],\r\n    layout: {\r\n      xaxis: {\r\n        title: 'Time',\r\n        showgrid: true,\r\n        zeroline: false,\r\n        linecolor: 'black',\r\n        linewidth: 1,\r\n        mirror: true\r\n      },\r\n      yaxis: {\r\n          title: 'Concentration',\r\n          showgrid: true,\r\n          zeroline: false,\r\n          // type: 'log',\r\n          linecolor: 'black',\r\n          linewidth: 1,\r\n          mirror: true\r\n      }\r\n    },\r\n    frames: [], \r\n    config: {scrollZoom: true, responsive: false}\r\n  });\r\n\r\n  console.log('function called');\r\n  \r\n  function onUpdate(figure) {\r\n    console.log('on update');\r\n\r\n    figure.data = props.graphData\r\n\r\n    setFigure(figure)\r\n  }\r\n\r\n  function onInitialized(figure) {\r\n    console.log(\"on initialized\")\r\n    setFigure(figure)\r\n  }\r\n\r\n  return (\r\n    <Plot\r\n      data={figure.data}\r\n      layout={figure.layout}\r\n      frames={figure.frames}\r\n      config={figure.config}\r\n      onInitialized={onInitialized}\r\n      onUpdate={onUpdate}\r\n      //onHover={console.log('onHover')}\r\n    />\r\n  );\r\n}*/","import logo from './logo.svg';\r\nimport React from 'react';\r\nimport './App.css';\r\n// import InputSlider from './Slider.js'\r\nimport InitCondTable from './initCondTable.js';\r\nimport RatesTable from './ratesTable.js'\r\nimport Grid from '@material-ui/core/Grid';\r\nimport TextArea from './textArea.js';\r\nimport { GeneralModel } from './general_model.js';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Autocomplete from '@material-ui/lab/Autocomplete';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport { kineticModels } from './models.js';\r\nimport ToggleButton from '@material-ui/lab/ToggleButton';\r\n\r\n\r\n// import React from 'react';\r\n// import Icon from '@material-ui/core/Icon';\r\nimport PlotlyGraph from './graph.js'\r\n\r\nimport { BlockMath } from 'react-katex';\r\nimport 'katex/dist/katex.min.css';\r\nimport { TextareaAutosize } from '@material-ui/core';\r\n\r\n\r\nclass App extends React.Component {\r\n\r\n  constructor() {\r\n    super()\r\n    this.state = {\r\n      initData: [],\r\n      ratesData: [],\r\n      schemeText: \"A = B = C = D = E\",\r\n      // schemeText: \"S + I = 2I\\nI = R = S\",\r\n\r\n      figure: {\r\n        data: [],\r\n        layout: {\r\n          xaxis: {\r\n            title: 'Time',\r\n            showgrid: true,\r\n            zeroline: false,\r\n            linecolor: 'black',\r\n            type: 'linear',\r\n            linewidth: 2,\r\n            mirror: true\r\n          },\r\n          yaxis: {\r\n              title: 'Concentration',\r\n              showgrid: true,\r\n              zeroline: false,\r\n              type: 'linear',\r\n              linecolor: 'black',\r\n              linewidth: 2,\r\n              mirror: true\r\n          },\r\n          autosize: true\r\n          \r\n        },\r\n        frames: [], \r\n        config: {scrollZoom: true, responsive: false},\r\n        revision: 0  // when this value is changed, it forces the plot to redraw\r\n      },\r\n\r\n      texEquation: '',\r\n      texModel: '',\r\n      cbNonZero: false\r\n    };\r\n\r\n    this.model = null;\r\n    this.modelSubmitted = this.modelSubmitted.bind(this);\r\n    this.sliderValueChanged = this.sliderValueChanged.bind(this);\r\n    this.cbNonZero_checkedChanged = this.cbNonZero_checkedChanged.bind(this);\r\n    this.textChangedCallback = this.textChangedCallback.bind(this);\r\n    this.sliderLogToggledCallback = this.sliderLogToggledCallback.bind(this);\r\n    this.modelChanged = this.modelChanged.bind(this);\r\n    // this.tbLogXChanged = this.tbLogXChanged.bind(this);\r\n    // this.transferParsToModel = this.transferParsToModel.bind(this);\r\n\r\n    // this.options = top100Films.map((option) => {\r\n    //   const firstLetter = option.title[0].toUpperCase();\r\n    //   return {\r\n    //     firstLetter: /[0-9]/.test(firstLetter) ? '0-9' : firstLetter,\r\n    //     ...option,\r\n    //   };\r\n    // });\r\n\r\n    // console.log(this.options)\r\n\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.modelSubmitted();  // load default model after all components have loaded\r\n  }\r\n\r\n  simulModel(useZeroBR=false) {\r\n    let range = [0, 10];\r\n    let steps = 200;\r\n\r\n    let comps = this.model.getCompartments();\r\n    let solution = this.model.simulateModel(steps, range, useZeroBR);\r\n\r\n    //var graphData = new Array(comps.length);\r\n\r\n    var figure = this.state.figure\r\n\r\n    // update figure data\r\n    let diff = comps.length - figure.data.length;  // difference in number of current compartments and from new model\r\n    if (diff > 0) {\r\n        for (let i = 0; i < diff; i++)\r\n          figure.data.push({\r\n              x: [],\r\n              y: [],\r\n              mode: 'lines',\r\n              type: 'scatter',\r\n              name: ''\r\n            });\r\n    } else if (diff < 0){\r\n        for (let i = 0; i < -diff; i++)\r\n            figure.data.pop();\r\n    }\r\n\r\n    for (let i = 0; i < comps.length; i++) {\r\n      figure.data[i].x = solution.xVals\r\n      figure.data[i].y = solution.yVals[i]\r\n      figure.data[i].name = `${comps[i]}`\r\n    }\r\n    figure.revision += 1\r\n\r\n    return figure;\r\n  }\r\n\r\n  textChangedCallback(text) {\r\n    this.setState({\r\n      schemeText: text\r\n    })\r\n  }\r\n\r\n  modelSubmitted(selecteModel) {\r\n    let scheme = this.state.schemeText\r\n\r\n    if (scheme === \"\" || scheme.match(/[^\\s]+/g) === null){\r\n      alert('Scheme is empty!');\r\n      return;\r\n    }\r\n\r\n    let lastInitData = this.state.initData;\r\n    let lastRatesData = this.state.ratesData;\r\n\r\n    this.model = GeneralModel.fromText(scheme);\r\n    let comps = this.model.getCompartments();\r\n    let compsF = this.model.getLatexFormattedCompartments();\r\n    let rateNames = this.model.getRateNames(false, true);\r\n\r\n    let initData = new Array(comps.length);\r\n\r\n    for (let i = 0; i < initData.length; i++) {\r\n      // value from previous model\r\n      let init_value = (i < lastInitData.length) ? lastInitData[i].init : this.model.initial_conditions[comps[i]];\r\n      let log = (i < lastInitData.length) ? lastInitData[i].log : false;\r\n\r\n      let condition = typeof selecteModel === 'undefined';\r\n\r\n      initData[i] = {\r\n        texName: compsF[i], \r\n        init: condition ? init_value : selecteModel.initialConditions[comps[i]].value,\r\n        log: condition? log : selecteModel.initialConditions[comps[i]].logSlider,\r\n        min: condition? 0 : selecteModel.initialConditions[comps[i]].min,\r\n        max: condition? 50 : selecteModel.initialConditions[comps[i]].max\r\n      }\r\n      // transfer params to model\r\n      this.model.initial_conditions[comps[i]] = initData[i].init;\r\n    }\r\n    \r\n    // comps.map((c, i) => ({\r\n    //   texName: compsF[i], \r\n    //   init: (i < lastInitData.length) ? lastInitData[i].init : this.model.initial_conditions[c]\r\n    // }));\r\n\r\n    let ratesData = new Array(rateNames.length);\r\n    for (let i = 0; i < rateNames.length; i++) {\r\n      // values from previous model\r\n      let fr_val = (i < lastRatesData.length) ? lastRatesData[i].fr : this.model.elem_reactions[i].forward_rate;\r\n      let br_val = (i < lastRatesData.length) ? lastRatesData[i].br : this.model.elem_reactions[i].backward_rate;\r\n\r\n      let log_fr = (i < lastRatesData.length) ? lastRatesData[i].log_fr : false;\r\n      let log_br = (i < lastRatesData.length) ? lastRatesData[i].log_br : false;\r\n\r\n      let condition = typeof selecteModel === 'undefined' || typeof selecteModel.rates === 'undefined';\r\n\r\n      ratesData[i] = {\r\n        texName:  rateNames[i],\r\n        fr: condition ? fr_val : selecteModel.rates[i].forwardRate,\r\n        br: condition ? br_val : selecteModel.rates[i].backwardRate,\r\n        log_fr: condition ? log_fr : selecteModel.rates[i].forwardRateLogSlider, \r\n        log_br: condition ? log_br : selecteModel.rates[i].backwardRateLogSlider,\r\n        min_fr: condition ? 0 : selecteModel.rates[i].forwardRateMin,\r\n        max_fr: condition ? 10 : selecteModel.rates[i].forwardRateMax,\r\n        min_br: condition ? 0 : selecteModel.rates[i].backwardRateMin,\r\n        max_br: condition ? 10 : selecteModel.rates[i].forwardRateMax\r\n      }\r\n      // transfer params to model\r\n      this.model.elem_reactions[i].forward_rate = ratesData[i].fr;\r\n      this.model.elem_reactions[i].backward_rate = ratesData[i].br;\r\n    }\r\n\r\n    this.model.buildFunc();\r\n\r\n    let figure = this.simulModel(!this.state.cbNonZero);\r\n\r\n    this.setState({\r\n      initData: initData,\r\n      ratesData: ratesData,\r\n      figure: figure,\r\n      texEquation: this.state.cbNonZero ? this.model.diffEquations : this.model.diffEquationsFRates,\r\n      texModel: this.state.cbNonZero ? this.model.latexModel : this.model.latexModelFRates \r\n    });\r\n  }\r\n\r\n  sliderLogToggledCallback(type, index) {\r\n\r\n    let initData = this.state.initData;\r\n    let ratesData = this.state.ratesData;\r\n\r\n    switch (type) {\r\n      case \"init\":  // changing of initial conditions\r\n          initData[index].log = !initData[index].log;\r\n          break;\r\n      case \"fr\":   // changing of forward rate constants\r\n          ratesData[index].log_fr = !ratesData[index].log_fr;\r\n          break;\r\n      case \"br\":   // changing of backward rate constants\r\n          ratesData[index].log_br = !ratesData[index].log_br;\r\n          break;\r\n    }\r\n    this.setState({\r\n      initData: initData,\r\n      ratesData: ratesData\r\n    });\r\n  }\r\n\r\n  sliderValueChanged(type, index, value) {\r\n    // console.log(name, value);\r\n\r\n    // let split = name.split('_');\r\n    // let text = split[0];\r\n    // let num = parseInt(split[1]);\r\n    let f_val = parseFloat(value);\r\n\r\n    let initData = this.state.initData;\r\n    let ratesData = this.state.ratesData;\r\n\r\n    switch (type) {\r\n        case \"init\":  // changing of initial conditions\r\n            let comps = this.model.getCompartments();\r\n            this.model.initial_conditions[comps[index]] = f_val;\r\n            initData[index].init = f_val;\r\n            break;\r\n        case \"fr\":   // changing of forward rate constants\r\n            this.model.elem_reactions[index].forward_rate = f_val;\r\n            ratesData[index].fr = f_val;\r\n            break;\r\n        case \"br\":   // changing of backward rate constants\r\n            this.model.elem_reactions[index].backward_rate = f_val;\r\n            ratesData[index].br = f_val;\r\n            break;\r\n    }\r\n\r\n    let figure = this.simulModel(!this.state.cbNonZero);\r\n\r\n    this.setState({\r\n      figure: figure,\r\n      initData: initData,\r\n      ratesData: ratesData\r\n    });\r\n  }\r\n\r\n  modelChanged(event, objectChosen) {\r\n    if (objectChosen === null)\r\n      return\r\n    this.state.schemeText = objectChosen.scheme;\r\n    this.state.cbNonZero = objectChosen.nonZeroBackwardRates;\r\n    // console.log(objectChosen.scheme)\r\n    this.modelSubmitted(objectChosen);\r\n  }\r\n\r\n  cbNonZero_checkedChanged(event) {\r\n\r\n    let figure = this.simulModel(!event.target.checked);\r\n\r\n    this.setState({\r\n      texEquation: event.target.checked ? this.model.diffEquations : this.model.diffEquationsFRates,\r\n      texModel: event.target.checked ? this.model.latexModel : this.model.latexModelFRates,\r\n      cbNonZero: event.target.checked,\r\n      figure: figure\r\n    });\r\n  }\r\n\r\n  // tbLogXChanged() {\r\n  //   let figure = this.state.figure;\r\n  //   figure.layout.xaxis.type = (figure.layout.xaxis.type === 'linear') ? 'log' : 'linear';\r\n  //   figure.revision += 1;\r\n  //   this.setState({figure: figure});\r\n  //   console.log(this.state.figure);\r\n  // }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        {/* <img src={logo} className=\"App-logo\" alt=\"logo\" /> */}\r\n        <p>Compartmental model simulator</p>\r\n  \r\n        <Grid container spacing={1} alignItems=\"column\" direction=\"row\">\r\n          <Grid item xs>\r\n\r\n            <Autocomplete\r\n              options={kineticModels.sort((a, b) => -b.class.localeCompare(a.class))}\r\n              groupBy={(option) => option.class}\r\n              getOptionLabel={(option) => option.name}\r\n              onChange={this.modelChanged}\r\n              renderInput={(params) => <TextField {...params} label=\"Kinetics models\" variant=\"outlined\" />}\r\n            />\r\n  \r\n            <TextArea schemeText={this.state.schemeText} modelSubmitCallback={this.modelSubmitted} textChangedCallback={this.textChangedCallback}/>\r\n\r\n            <FormControlLabel\r\n                control={<Checkbox color=\"secondary\" checked={this.state.cbNonZero} onChange={this.cbNonZero_checkedChanged} name=\"cbNonZero\" />}\r\n                label=\"Non-zero backwards rates\"\r\n            />\r\n\r\n            <BlockMath math={`${this.state.texModel} `} errorColor={'#cc0000'}/>  {/* without space it will through an error: KaTeX can only parse string typed expression */}\r\n            {/* <BlockMath math={`\\\\begin{aligned} ${this.state.texModel} \\\\end{aligned}`} errorColor={'#cc0000'}/> */}\r\n            <BlockMath math={`${this.state.texEquation} `} errorColor={'#cc0000'}/>  {/* without space it will through an error: KaTeX can only parse string typed expression */}\r\n\r\n\r\n            {/* <BlockMath math={`\\\\begin{aligned} ${this.state.texEquation} \\\\end{aligned}`} errorColor={'#cc0000'}/> */}\r\n  \r\n            <InitCondTable \r\n              data={this.state.initData} \r\n              sliderChangedCallback={this.sliderValueChanged}\r\n              sliderLogToggledCallback={this.sliderLogToggledCallback}>\r\n            </InitCondTable>\r\n\r\n            <RatesTable \r\n              data={this.state.ratesData} \r\n              sliderChangedCallback={this.sliderValueChanged}\r\n              sliderLogToggledCallback={this.sliderLogToggledCallback}\r\n              disabled={!this.state.cbNonZero}>\r\n            </RatesTable>\r\n\r\n            <ToggleButton\r\n                selected={(this.state.figure.layout.xaxis.type === 'linear') ? false : true}\r\n                onChange={() => {\r\n                  let figure = this.state.figure;\r\n                  figure.layout.xaxis.type = (figure.layout.xaxis.type === 'linear') ? 'log' : 'linear';\r\n                  figure.revision += 1;\r\n                  this.setState({figure: figure});\r\n                }}\r\n              >Log x</ToggleButton>\r\n\r\n            <ToggleButton\r\n                selected={(this.state.figure.layout.yaxis.type === 'linear') ? false : true}\r\n                onChange={() => {\r\n                  let figure = this.state.figure;\r\n                  figure.layout.yaxis.type = (figure.layout.yaxis.type === 'linear') ? 'log' : 'linear';\r\n                  figure.revision += 1;\r\n                  this.setState({figure: figure});\r\n                }}\r\n              >Log y</ToggleButton>\r\n  \r\n          </Grid>\r\n          <Grid item xs>\r\n            <PlotlyGraph \r\n              data={this.state.figure.data}\r\n              frames={this.state.figure.frames}\r\n              config={this.state.figure.config}\r\n              layout={this.state.figure.layout}\r\n              revision={this.state.figure.revision}\r\n             />\r\n             \r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n// function App() {\r\n//   return (\r\n//     <div className=\"App\">\r\n//       {/* <img src={logo} className=\"App-logo\" alt=\"logo\" /> */}\r\n//       <p>Application  react</p>\r\n\r\n//       <Grid container spacing={1} alignItems=\"column\" direction=\"row\">\r\n//         <Grid item xs>\r\n\r\n//           <TextArea text=\"A = B = C = D = E\"/>\r\n\r\n//           <InitCondTable data={init}></InitCondTable>\r\n//           <RatesTable data={data}></RatesTable>\r\n\r\n//         </Grid>\r\n//         <Grid item xs>\r\n//           <PlotlyGraph />\r\n//         </Grid>\r\n//       </Grid>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n\r\n// function App() {\r\n//   return <Button color=\"primary\">Hello World</Button>;\r\n// }\r\n\r\n// function App() {\r\n//   return (\r\n//     <div className=\"App\">\r\n//       <header className=\"App-header\">\r\n//         <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n//         <p>\r\n//           Edit <code>src/App.js</code> and save to reload.\r\n//         </p>\r\n//         <a\r\n//           className=\"App-link\"\r\n//           href=\"https://reactjs.org\"\r\n//           target=\"_blank\"\r\n//           rel=\"noopener noreferrer\"\r\n//         >\r\n//           Learn React\r\n//         </a>\r\n//       </header>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","// -------------------------------------------------------------------------------\r\n// RK45js : A JavaScript implementation of the Runge-Kutta-Fehlberg method.\r\n// from https://github.com/imiRemy/RK45js\r\n//\r\n// The Runge-Kutta-Fehlberg method (RK45 method) is a numerical integration\r\n// routine for solving systems of differential equations.  RK45 differs from\r\n// the normal Runge-Kutta algorithm by featuring an adapative step size. As\r\n// the integration proceeds, if the step size is too big (i.e. produces an\r\n// error larger than a set value) then the step size is decreased until the\r\n// error is within an acceptable value.  Conversely, if the error is much\r\n// smaller than the tolerance, the step size is increased to improve computational\r\n// efficiency.\r\n//\r\n// This implementation is written in JavaScript and is based loosely off an\r\n// older C version I wrote some time ago.\r\n//\r\n// Features:\r\n//      - Computational solver can be instantiated as an object.\r\n//      - No fixed limit to the order (size) of the system that can be solved.\r\n//      - Sanity checking built-in prior to starting computation.\r\n//      - Unit test suite (Mocha + Chai) for testing your installation.\r\n//\r\n// Getting Started:\r\n// At the most basic level, you need to do the following:\r\n//      - Instantiate a solver\r\n//      - Define the derivative function(s) you are solving\r\n//      - Set the intial conditions\r\n//      - Specify the start and stop values in the independent variable; e.g. time.\r\n//      - Call the solver.\r\n//      - Read out your answer!\r\n//\r\n// See the \"rk45_sample.js\" file for an example of getting started with a one\r\n// degree of freedom (first order) system.\r\n//\r\n// Remy Malan\r\n// February 2017\r\n//\r\n// License: MIT\r\n// -------------------------------------------------------------------------------\r\n\r\nvar debug = require('debug')('rk45');\r\n// var debug = console.log;\r\n\r\n\r\nexports.System = function() {\r\n    this.x0 = null;         // Array of initial conditions.\r\n    this.fn = null;         // Array of functions to solve.\r\n    this.newX = null;       // Array of solved values.\r\n    this.h = 0.1;           // Time step.\r\n    this.tol = 5.0e-7;      // Solution tolerance; used for adaptive step size adjustment.\r\n    this.start = 0.0;       // Integration start time.\r\n    this.stop = 1.0;        // Integration end time.\r\n    this.R = null;          // Array for error calculations.\r\n    this.delta = null;      // Array for step adjustment.\r\n    this.count = 0;         // Count of how many steps of integration were done.\r\n    this.maxCount = 5000;   // Watchdog value for integration loop counter.\r\n    this.status =           // Error / success status.\r\n        {success: false,    // True if solved correctly, false otherwise.\r\n         state: 'init',     // Label of state of solver: 'init', 'solve', 'complete', 'error'\r\n         message: null};    // More detailed info.\r\n    this.result = null;\r\n}\r\n\r\nexports.System.prototype = {\r\n\r\n    // Set initial conditions.\r\n    setInitX:   function( initX ) { return this.x0 = initX; },\r\n    setFn:      function( fn_array ) { return this.fn = fn_array; },\r\n    setStart:   function( start_time ) { return this.start = start_time; },\r\n    setStop:    function( stop_time ) { return this.stop = stop_time; },\r\n    setH:       function( h ) { return this.h = h; },\r\n    setTol:     function( tol ) { return this.tol = tol; },\r\n    setMaxCount:function( maxCount ) { return this.maxCount = maxCount; },\r\n\r\n    // Get status.\r\n    getStatus:  function() { return this.status; },\r\n    \r\n    // Check that \"obvious\" issues are not present before trying to solve.\r\n    checkSetUp: function() {\r\n        if (this.start >= this.stop) {\r\n            this.status.state = 'error';\r\n            if (this.start == this.stop)\r\n                this.status.message = 'Stop time same as start time.';\r\n            else\r\n                this.status.message = 'Stop time is less than start time.';\r\n            return( this.status.state );\r\n        }\r\n        // if (this.x0.length != this.fn.length) {\r\n        //     this.status.state = 'error';\r\n        //     this.status.message = 'Dimension of initial conditions not the same as dimension of functions.';\r\n        //     return( this.status.state );\r\n        // }\r\n        if (this.h <= 0) {\r\n            this.status.state = 'error';\r\n            if (this.h == 0.0)\r\n                this.status.message = 'h is zero but must be a positive number.';\r\n            else\r\n                this.status.message = 'h is less than zero but must be a positive number.';\r\n            return( this.status.state );\r\n        }\r\n        return( 'ok' );\r\n    },\r\n \r\n    \r\n\r\n    // Compute 'k' coefficients, k1 - k6.\r\n    computeK:   function(t) {\r\n        var t_new = t;\r\n        var x_new = this.newX.slice();\r\n        var dimension = this.x0.length;\r\n        var k = new Array(dimension);\r\n        // k1\r\n        let f_vals = this.fn(t_new,x_new)\r\n        for (var i=0; i<dimension; i++) {\r\n            k[i] = new Array(6);\r\n            k[i][0] = this.h * f_vals[i];\r\n        }\r\n        // k2\r\n        t_new = t + this.h / 4.0;\r\n        for (var i=0; i<dimension; i++) {\r\n            x_new[i] = this.newX[i] + k[i][0] / 4.0;\r\n        }\r\n        f_vals = this.fn(t_new,x_new)\r\n        for (var i=0; i<dimension; i++) {\r\n            k[i][1] = this.h * f_vals[i];\r\n        }\r\n        // k3\r\n        t_new = t + this.h * 3.0 / 8.0;\r\n        for (var i=0; i<dimension; i++) {\r\n            x_new[i] = this.newX[i] + (3.0*k[i][0] + 9.0*k[i][1])/32.0;\r\n        }\r\n        f_vals = this.fn(t_new,x_new)\r\n        for (var i=0; i<dimension; i++) {\r\n            k[i][2] = this.h * f_vals[i];\r\n        }\r\n        // k4\r\n        t_new = t + this.h * 12.0 / 13.0;\r\n        for (var i=0; i<dimension; i++) {\r\n            x_new[i] = this.newX[i] + (1932.0*k[i][0] - 7200.0*k[i][1] + 7296.0*k[i][2])/2197.0;\r\n        }\r\n        f_vals = this.fn(t_new,x_new)\r\n        for (var i=0; i<dimension; i++) {\r\n            k[i][3] = this.h * f_vals[i];\r\n        }\r\n        // k5\r\n        t_new = t + this.h;\r\n        for (var i=0; i<dimension; i++) {\r\n            x_new[i] = this.newX[i] + 439.0*k[i][0]/216.0 - 8.0*k[i][1] + 3680.0*k[i][2]/513.0 - 845.0*k[i][3]/4104.0;\r\n        }\r\n        f_vals = this.fn(t_new,x_new)\r\n        for (var i=0; i<dimension; i++) {\r\n            k[i][4] = this.h * f_vals[i];\r\n        }\r\n        // k6\r\n        t_new = t + this.h / 2.0;\r\n        for (var i=0; i<dimension; i++) {\r\n            x_new[i] = this.newX[i] - 8.0*k[i][0]/27.0 + 2.0*k[i][1] - 3544.0*k[i][2]/2565.0 + 1859.0*k[i][3]/4104.0 - 11.0*k[i][4]/40.0;\r\n        }\r\n        f_vals = this.fn(t_new,x_new)\r\n        for (var i=0; i<dimension; i++) {\r\n            k[i][5] = this.h * f_vals[i];\r\n        }\r\n        \r\n        return( k );\r\n    },\r\n\r\n    // Run computation loop.\r\n    solve:      function() {\r\n\r\n        // Check for inconsistencies in user inputs.\r\n        if (this.checkSetUp() != 'ok') {\r\n            return;\r\n        }\r\n\r\n        var dimension = this.x0.length;         // Dimension or order of the system.\r\n        var t = this.start;                     // Time variable.\r\n\r\n        // this.newX = new Array( dimension );\r\n        this.newX = this.x0                     // Output is set to initial values.\r\n        this.R = new Array( dimension );\r\n        this.delta = new Array( dimension );\r\n\r\n        this.count = 0;                         // Set loop counter to zero.\r\n\r\n        // console.log(`y(t = ${t}) = ${this.newX}, h = ${this.h}`);\r\n        \r\n        let xVals = new Array();\r\n        xVals.push(t);\r\n        let yVals = new Array(dimension);\r\n        for (var i = 0; i < dimension; i++){\r\n            yVals[i] = new Array();\r\n            yVals[i].push(this.newX[i]);\r\n        }\r\n\r\n\r\n        while (t < this.stop) {\r\n\r\n            debug(\"t: \"+t+\", newX: \"+this.newX);\r\n            \r\n            // Compute the 'k' coefficients.\r\n            var k = this.computeK(t);\r\n\r\n            for (var i=0; i<k.length; i++) {\r\n                debug(\"k[\"+i+\"]: \"+k[i]);\r\n//                for (var j=0; j<k[i].length; j++)\r\n//                   debug(\"k[\"+i+\"][\"+j+\"]: \"+k[i][j]);\r\n            }\r\n            \r\n            // Compute error estimates and\r\n            // step size adjustment.\r\n            \r\n            for (var i=0; i<dimension; i++) {\r\n                this.R[i] = Math.abs( k[i][0]/360.0 - 128.0*k[i][2]/4275.0 - 2197.0*k[i][3]/75240.0 + k[i][4]/50.0 + 2*k[i][5]/55.0 );\r\n                this.R[i] = this.R[i] / this.h;\r\n                this.delta[i] = 0.84*Math.pow((this.tol/this.R[i]),0.25);\r\n            }\r\n            \r\n            debug(\"delta: \" + this.delta + \"; min: \" + Math.min.apply(null, this.delta));\r\n\r\n            if (Math.max.apply(null,this.R) <= this.tol)  {\r\n                debug(\"Good to compute!\");\r\n                t = t + this.h;\r\n                xVals.push(t);\r\n                for (var i=0; i<dimension; i++) {\r\n                    this.newX[i] = this.newX[i] + (25.0*k[i][0]/216.0 + 1408.0*k[i][2]/2565.0 + 2197.0*k[i][3]/4104.0 - k[i][4]/5.0);\r\n                    yVals[i].push(this.newX[i]);\r\n                }\r\n                // console.log(`y(t = ${t}) = ${this.newX}, h = ${this.h}`);\r\n            }\r\n            else {\r\n                debug(\"Need to adjust step size, max R: \"+Math.max.apply(null,this.R));\r\n                debug(\"Scale factor: \"+Math.min.apply(null, this.delta));\r\n            }\r\n            this.h = this.h * Math.min.apply(null, this.delta);\r\n            \r\n    \t\tif (this.h >= (this.stop - t))\r\n\t\t\t    this.h = this.stop - t;\r\n\t\t    \r\n\t\t    if (this.count++ > this.maxCount) {\r\n\t\t\t    break;\r\n\t\t\t}\r\n        }\r\n        \r\n        // Check why loop stopped.\r\n \r\n \t\tif (this.count++ > this.maxCount) {\r\n\t\t    this.status.success = false;\r\n\t\t    this.status.state = 'error';\r\n\t\t    this.status.message = 'Iteration count exceeded MAX count (' + this.maxCount + ')';\r\n\r\n            this.result = {\r\n                xVals: [],\r\n                yVals: []\r\n            }\r\n\r\n        }\r\n        else if (t >= this.stop) {\r\n\t\t    this.status.success = true;\r\n\t\t    this.status.state = 'complete';\r\n\t\t    this.status.message = 'Integration completed sucessfully.';\r\n\r\n            this.result = {\r\n                xVals: xVals,\r\n                yVals: yVals\r\n            }\r\n        }  \r\n    }\r\n        \r\n}"],"sourceRoot":""}
(this["webpackJsonpcompartmental-model-simulator"]=this["webpackJsonpcompartmental-model-simulator"]||[]).push([[0],{56:function(a,e,t){},86:function(a,e,t){},96:function(a,e,t){"use strict";t.r(e);var r=t(5),i=t(0),n=t.n(i),o=t(11),l=t.n(o),d=(t(86),t(51)),c=t(31),s=t(22),f=t(16),m=t(65),h=t(64),u=(t.p,t(56),t(145)),b=t(149),g=t(148),w=t(143),R=t(146),x=t(147),k=t(144),v=t(136),p=t(4),j=t(140),M=t(157),S=t(142),C=t(141),y=Object(v.a)({root:{width:250},input:{width:100}}),O=Object(p.a)({thumb:{backgroundColor:"#ffffff",border:"3px solid currentColor"},active:{}})(M.a);function _(a,e){if(0==a)return 0;var t=Math.ceil(Math.log10(a<0?-a:a)),r=e-Math.floor(t),i=Math.pow(10,r);return Math.round(a*i)/i}function L(a){var e=a.steps,t=a.min,i=a.max,n=a.color,o=a.log,l=a.type,d=a.index,c=a.value,s=a.sliderChangedCallback,f=a.sliderLogToggledCallback,m=a.disabled,h=y();c="number"===typeof c?c:0,o&&(t=t<1e-4?1e-4:t);var u=(i-t)/e,b=(Math.log(i)-Math.log(t))/e,g=o?Math.exp(Math.log(c)+b)-c:u;return g=_(g,3),console.log(g),Object(r.jsx)("div",{children:Object(r.jsxs)(j.a,{container:!0,spacing:2,alignItems:"center",children:[Object(r.jsx)(j.a,{item:!0,xs:!0,children:Object(r.jsx)(C.a,{selected:o,disabled:m,onChange:function(){return f(l,d)},children:"Log"})}),Object(r.jsx)(j.a,{item:!0,xs:!0,children:Object(r.jsx)(O,{value:o?Math.log(c):c,onChange:function(a,e){if(c!==e){var t=!0===o?Math.exp(e):e;s(l,d,_(t,3))}},"aria-labelledby":"input-slider",min:o?Math.log(t):t,max:o?Math.log(i):i,step:o?b:u,color:n,disabled:m})}),Object(r.jsx)(j.a,{item:!0,children:Object(r.jsx)(S.a,{value:c,margin:"dense",className:h.input,onChange:function(a){var e=""===a.target.value?0:Number(a.target.value);c!==e&&s(l,d,_(e,3))},inputProps:{min:t,max:i,step:g,type:"number","aria-labelledby":"input-slider"},disabled:m})})]})})}var B=t(34);t(49);function E(a){var e=a.data,t=a.sliderChangedCallback,i=a.sliderLogToggledCallback;return Object(r.jsx)(w.a,{component:k.a,children:Object(r.jsxs)(u.a,{size:"small","aria-label":"simple table",children:[Object(r.jsx)(R.a,{children:Object(r.jsxs)(x.a,{children:[Object(r.jsx)(g.a,{align:"center",children:"Compartment"}),Object(r.jsx)(g.a,{align:"center",children:"Initial conditions"})]})}),Object(r.jsx)(b.a,{children:e.map((function(a,e){return Object(r.jsxs)(x.a,{children:[Object(r.jsx)(g.a,{align:"center",children:Object(r.jsx)(B.InlineMath,{math:a.texName,errorColor:"#cc0000"})}),Object(r.jsx)(g.a,{align:"center",children:Object(r.jsx)(L,{log:a.log,steps:100,min:a.min,max:a.max,value:a.init,type:"init",index:e,color:"primary",sliderChangedCallback:t,sliderLogToggledCallback:i})})]})}))})]})})}function D(a){var e=a.data,t=a.disabled,i=a.sliderChangedCallback,n=a.sliderLogToggledCallback;return Object(r.jsx)(w.a,{component:k.a,children:Object(r.jsxs)(u.a,{size:"small","aria-label":"simple table",children:[Object(r.jsx)(R.a,{children:Object(r.jsxs)(x.a,{children:[Object(r.jsx)(g.a,{align:"center",children:"Rate constant"}),Object(r.jsx)(g.a,{align:"center",children:"Forward rates"}),Object(r.jsx)(g.a,{align:"center",children:"Backward rates"})]})}),Object(r.jsx)(b.a,{children:e.map((function(a,e){return Object(r.jsxs)(x.a,{children:[Object(r.jsx)(g.a,{align:"center",children:Object(r.jsx)(B.InlineMath,{math:a.texName,errorColor:"#cc0000"})}),Object(r.jsx)(g.a,{align:"center",children:Object(r.jsx)(L,{log:a.log_fr,steps:100,min:a.min_fr,max:a.max_fr,value:a.fr,type:"fr",index:e,sliderChangedCallback:i,sliderLogToggledCallback:n,color:"primary"})}),Object(r.jsx)(g.a,{align:"center",children:Object(r.jsx)(L,{log:a.log_br,steps:100,min:a.min_br,max:a.max_br,value:a.br,type:"br",index:e,sliderChangedCallback:i,sliderLogToggledCallback:n,disabled:t,color:"secondary"})})]})}))})]})})}var T=t(98),A=t(150);function N(a){var e=a.schemeText,t=a.modelSubmitCallback,i=a.textChangedCallback;return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"text-area",children:Object(r.jsx)(T.a,{onChange:function(a){return i(a.target.value)},"aria-label":"empty textarea",placeholder:">> Place kinetic model here <<",style:{fontSize:18,fontFamily:"Palatino"},value:e})}),Object(r.jsx)(A.a,{variant:"contained",onClick:function(){return t()},color:"primary",children:"Submit"})]})}var I=t(52);function Z(a,e,t){for(var r=new Array(t),i=0;i<t;i++)r[i]=e[i]*a;return r}function q(a,e,t){for(var r=0;r<t;r++)e[r]+=a[r];return e}var P=new Error("The destination of the undependent variable has to be greater than its start");function F(a,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=t[0],n=t[1];if(n<=i)throw P;var o=(n-i)/r;return e.length>1?V(a,r,o,e,i):H(a,r,o,e,i)}function H(a,e,t,r,i){var n=i,o=new Array(e+1),l=new Array(e+1);o[0]=n,l[0]=r;for(var d,c,s,f,m=0;m<e;)d=a(n,l[m]),c=a(n+.5*t,l[m]+.5*t*d),s=a(n+.5*t,l[m]+.5*t*c),f=a(n+t,l[m]+t*s),l[m+1]=l[m]+t*(d+2*c+2*s+f)/6,n+=t,o[++m]=n;return{xVals:o,yVals:l}}function V(a,e,t,r,i){var n,o,l,d,c=r.length,s=i,f=r,m=new Array(e+1);m[0]=s;for(var h=new Array(c),u=0;u<c;u++)h[u]=new Array(e+1),h[u][0]=f[u];for(var b=1;b<=e;b++){n=a(s,f),o=a(s+.5*t,q(f,Z(.5*t,n,c),c)),l=a(s+.5*t,q(f,Z(.5*t,o,c),c)),d=a(s+t,q(f,Z(t,l,c),c));for(var g=0;g<c;g++)f[g]+=t*(n[g]+2*o[g]+2*l[g]+d[g])/6,h[g][b]=f[g];s+=t,m[b]=s}return{xVals:m,yVals:h}}Array.prototype.equals&&console.warn("Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code."),Array.prototype.equals=function(a){if(!a)return!1;if(this.length!==a.length)return!1;for(var e=0,t=this.length;e<t;e++)if(this[e]instanceof Array&&a[e]instanceof Array){if(!this[e].equals(a[e]))return!1}else if(this[e]!==a[e])return!1;return!0},Object.defineProperty(Array.prototype,"equals",{enumerable:!1});var z=function(){function a(){Object(c.a)(this,a),this.initial_conditions={},this.elem_reactions=[],this.scheme="",this.func=null,this.diffEquations="",this.diffEquationsFRates=""}return Object(s.a)(a,[{key:"addElementaryReaction",value:function(){for(var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["A","A"],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["B","C"],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={from_comp:a,to_comp:e,forward_rate:t,backward_rate:r},n=0;n<this.elem_reactions.length;n++){var o=this.elem_reactions[n];if(o.from_comp.equals(i.from_comp)&&o.to_comp.equals(i.to_comp))return o.forward_rate=i.forward_rate,void(o.backward_rate=i.backward_rate)}this.elem_reactions.push(i)}},{key:"getCompartments",value:function(){var a=[];return this.elem_reactions.forEach((function(e){e.from_comp.forEach((function(e){a.includes(e)||a.push(e)})),e.to_comp.forEach((function(e){a.includes(e)||a.push(e)}))})),a}},{key:"getLatexFormattedCompartments",value:function(){var a,e=[],t=Object(I.a)(this.getCompartments());try{var r=function(){for(var t=a.value.split(""),r="",i=null,n=function(){null!=i&&(r+="_{".concat(i,"}"),i=null)},o=0;o<t.length;o++)isNaN(t[o])?(n(),r+=t[o]):(i=null==i?"":i,i+=t[o],o===t.length-1&&n());r="\\mathrm{".concat(r.replaceAll(".","\\cdot "),"}"),e.push(r)};for(t.s();!(a=t.n()).done;)r()}catch(i){t.e(i)}finally{t.f()}return e}},{key:"getRateNames",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getCompartments(),r=this.getLatexFormattedCompartments(),i={},n=0;n<t.length+1;n++)i[t[n]]=r[n];var o,l=[],d=Object(I.a)(this.elem_reactions);try{for(d.s();!(o=d.n()).done;){var c=o.value,s=c.from_comp.map((function(a){return i[a]})),f=c.to_comp.map((function(a){return i[a]})),m=a.occurences(s),h=a.occurences(f);for(var u in s=[],f=[],m){var b=m[u];s.push(1===b?u:"".concat(b).concat(u))}for(var g in h){var w=h[g];f.push(1===w?g:"".concat(w).concat(g))}var R=e?"\\rightarrow":"\\rightleftharpoons",x="k_{".concat(s.join("+")," ").concat(R," ").concat(f.join("+"),"}"),k="{\\color{blue}".concat(x,"}"),v="{\\color{red}k_{".concat(s.join("+")," \\leftarrow ").concat(f.join("+"),"}}");l.push(e?[k,v]:x)}}catch(p){d.e(p)}finally{d.f()}return l}},{key:"printModel",value:function(){console.log("Scheme: ".concat(this.scheme)),console.log("Initial conditions:",this.initial_conditions),this.elem_reactions.forEach((function(a){console.log("Elementary reaction: ".concat(a.from_comp.join(" + ")," -> ").concat(a.to_comp.join(" + "),", forward_rate=").concat(a.forward_rate,", backward_rate=").concat(a.backward_rate))}))}},{key:"simulateModel",value:function(){for(var a=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,100],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object.values(this.initial_conditions),n=new Array(this.elem_reactions.length),o=new Array(this.elem_reactions.length),l=0;l<this.elem_reactions.length;l++)n[l]=this.elem_reactions[l].forward_rate,o[l]=r?0:this.elem_reactions[l].backward_rate;var d=F((function(e,t){return a.func(e,t,n,o)}),i,t,e);return d}},{key:"_buildDiffEq",value:function(e,t){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getRateNames(!0),n=this.getLatexFormattedCompartments(),o=n.length,l=new Array(o),d=new Array(o),c=0;c<o;c++)l[c]=[],d[c]=[];for(var s=function(o){var c=i[o][0],s=i[o][1],f=e[o].map((function(a){return"[".concat(n[a],"]")})),m=t[o].map((function(a){return"[".concat(n[a],"]")})),h=a.occurences(f),u=a.occurences(m);for(var b in h){var g=h[b];c+=1===g?b:"".concat(b,"^{").concat(g,"}")}for(var w in u){var R=u[w];s+=1===R?w:"".concat(w,"^{").concat(R,"}")}e[o].forEach((function(a){r&&l[a].push(s),d[a].push(c)})),t[o].forEach((function(a){l[a].push(c),r&&d[a].push(s)}))},f=0;f<this.elem_reactions.length;f++)s(f);for(var m="",h=0;h<o;h++){var u=a.occurences(l[h]),b=a.occurences(d[h],u,!0),g=[];for(var w in b){var R=b[w];if(0!==R){var x=R>0?"+":"-",k=1===Math.abs(R)?"":Math.abs(R);g.push("".concat(x).concat(k).concat(w))}}m+="\\frac{\\mathrm d[".concat(n[h],"]}{\\mathrm dt}&=").concat(g.join(""),"\\\\")}return m}},{key:"buildFunc",value:function(){for(var a=this.getCompartments(),e=a.length,t={},r=0;r<e;r++)t[a[r]]=r;for(var i=this.elem_reactions.length,n=[],o=[],l=[],d=[],c=0;c<i;c++){var s=this.elem_reactions[c],f=s.from_comp.map((function(a){return t[a]})),m=s.to_comp.map((function(a){return t[a]}));n.push(f),o.push(m),l[c]=s.forward_rate,d[c]=s.backward_rate}this.diffEquations=this._buildDiffEq(n,o,!0),this.diffEquationsFRates=this._buildDiffEq(n,o,!1),this.func=function(a,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null==r&&(r=l),null==c&&(c=d);for(var s=new Array(e).fill(0),f=0;f<i;f++){for(var m=r[f],h=c[f],u=0;u<n[f].length;u++)m*=t[n[f][u]];for(var b=0;b<o[f].length;b++)h*=t[o[f][b]];for(var g=0;g<n[f].length;g++)s[n[f][g]]+=h-m;for(var w=0;w<o[f].length;w++)s[o[f][w]]+=m-h}return s}}}],[{key:"occurences",value:function(a){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=null===e?{}:e;for(var r=t?-1:1,i=0;i<a.length;i++){var n=a[i];e[n]=e[n]?e[n]+r:r}return e}},{key:"fromText",value:function(e){var t=new a;t.scheme=e,e.split("\n").forEach((function(a){var e=(a=a.split("#")[0]).match(/[^\s]+/g);if(""!==a&&null!==e){a=e.join("");var r=[];a.split("=").forEach((function(a){var e=[];a.split("+").forEach((function(a){var t=/(\d)([\w\d\.]+)|([\w\d\.]+)/g.exec(a),r="undefined"==typeof t[3],i=r?parseInt(t[1]):1,n=r?t[2]:t[3];i<1&&(i=1);for(var o=0;o<i;o++)e.push(n)})),r.push(e)}));for(var i=0;i<r.length-1;i++)t.addElementaryReaction(r[i],r[i+1])}}));for(var r=t.getCompartments(),i=0;i<r.length;i++)t.initial_conditions[r[i]]=0===i?1:0;return t}}]),a}(),W=t(155),J=t(156),K=t(154),G=t(153),Q=[{class:"Funny models",name:"Cyclic model",description:"",scheme:"A = B = C = D = E = F = G = H = I = J = K = A",nonZeroBackwardRates:!1,initialConditions:{A:{logSlider:!1,min:0,max:50,value:1},B:{logSlider:!1,min:0,max:50,value:0},C:{logSlider:!1,min:0,max:50,value:0},D:{logSlider:!1,min:0,max:50,value:0},E:{logSlider:!1,min:0,max:50,value:0},F:{logSlider:!1,min:0,max:50,value:0},G:{logSlider:!1,min:0,max:50,value:0},H:{logSlider:!1,min:0,max:50,value:0},I:{logSlider:!1,min:0,max:50,value:0},J:{logSlider:!1,min:0,max:50,value:0},K:{logSlider:!1,min:0,max:50,value:0}}},{class:"Funny models",name:"Lotka-Volterra",description:"",scheme:"Rabbit = 2Rabbit\nWolf = DeadWolf\nWolf + Rabbit = 2Wolf",nonZeroBackwardRates:!1,initialConditions:{Rabbit:{logSlider:!1,min:0,max:50,value:1},Wolf:{logSlider:!1,min:0,max:50,value:1},DeadWolf:{logSlider:!1,min:0,max:50,value:0}},rates:[{forwardRate:4.4,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:1.9,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:1.3,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1}]},{class:"Epidemic",name:"SIR Model",description:"TODO",scheme:"Susceptible + Infected = 2Infected\nInfected = Recovered\nInfected = Dead",nonZeroBackwardRates:!1,initialConditions:{Susceptible:{logSlider:!1,min:0,max:100,value:10},Infected:{logSlider:!0,min:1e-5,max:10,value:.001},Recovered:{logSlider:!1,min:0,max:10,value:0},Dead:{logSlider:!1,min:0,max:10,value:0}},rates:[{forwardRate:.6,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:1.5,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.1,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1}]},{class:"Epidemic",name:"SEIRS Model",description:"TODO",scheme:"Susceptible + Infected = Exposed + Infected\nExposed = Infected = Recovered = Susceptible\nInfected = Dead",nonZeroBackwardRates:!1,initialConditions:{Susceptible:{logSlider:!1,min:0,max:100,value:10},Exposed:{logSlider:!1,min:0,max:100,value:0},Infected:{logSlider:!0,min:1e-5,max:10,value:1e-4},Recovered:{logSlider:!1,min:0,max:10,value:0},Dead:{logSlider:!1,min:0,max:10,value:0}},rates:[{forwardRate:4,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.8,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:2.4,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.3,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.1,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1}]},{class:"Chemical kinetics",name:"Michaelis-Menten",description:"TODO",scheme:"E + S = ES = E + P",nonZeroBackwardRates:!0,initialConditions:{E:{logSlider:!1,min:0,max:50,value:3.5},S:{logSlider:!1,min:0,max:50,value:10},ES:{logSlider:!1,min:0,max:50,value:0},P:{logSlider:!1,min:0,max:50,value:0}},rates:[{forwardRate:.4,backwardRate:1.4,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:1.9,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1}]},{class:"Chemical kinetics",name:"H2 + Br2",description:"TODO",scheme:"Br2 = 2Br.\nBr. + H2 = HBr + H.\nH. + Br2 = HBr + Br.",nonZeroBackwardRates:!0,initialConditions:{Br2:{logSlider:!1,min:0,max:50,value:1},"Br.":{logSlider:!1,min:0,max:50,value:0},H2:{logSlider:!1,min:0,max:50,value:1},HBr:{logSlider:!1,min:0,max:50,value:0},"H.":{logSlider:!1,min:0,max:50,value:0}},rates:[{forwardRate:.4,backwardRate:.9,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:2.9,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:1.2,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1}]},{class:"Photochemistry",name:"Photosensitization",description:"TODO",scheme:"tPS = PS\n2tPS = tPS + PS\ntPS + S = T + PS\nT = S",nonZeroBackwardRates:!1,initialConditions:{tPS:{logSlider:!1,min:0,max:50,value:1},PS:{logSlider:!1,min:0,max:50,value:0},S:{logSlider:!1,min:0,max:50,value:2},T:{logSlider:!1,min:0,max:50,value:0}},rates:[{forwardRate:.5,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.3,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:1,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.5,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1}]},{class:"Photochemistry",name:"Rose bengal kinetics",description:"TODO",scheme:"tRB = RB\ntRB + RB = 2RB\n2tRB = tRB + RB\ntRB + RB = raRB + rkRB\n2tRB = raRB + rkRB\nraRB + rkRB = 2RB",nonZeroBackwardRates:!1,initialConditions:{tRB:{logSlider:!1,min:0,max:50,value:1},RB:{logSlider:!1,min:0,max:50,value:0},raRB:{logSlider:!1,min:0,max:50,value:0},rkRB:{logSlider:!1,min:0,max:50,value:0}},rates:[{forwardRate:1.01,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.6,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:1.2,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:.2,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:2.4,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1},{forwardRate:4.5,backwardRate:0,forwardRateMin:0,forwardRateMax:10,backwardRateMin:0,backwardRateMax:10,forwardRateLogSlider:!1,backwardRateLogSlider:!1}]}],U=t(62),X=t.n(U);function Y(a){var e=a.data,t=a.layout,i=a.config,n=a.frames,o=a.revision;return Object(r.jsx)(X.a,{data:e,layout:t,config:i,frames:n,revision:o,useResizeHandler:!0,style:{width:"100%",height:"100%"}})}var $=function(a){Object(m.a)(t,a);var e=Object(h.a)(t);function t(){var a;return Object(c.a)(this,t),(a=e.call(this)).state={initData:[],ratesData:[],schemeText:"A = B = C = D = E",figure:{data:[],layout:{xaxis:{title:"Time",showgrid:!0,zeroline:!1,linecolor:"black",linewidth:2,mirror:!0},yaxis:{title:"Concentration",showgrid:!0,zeroline:!1,linecolor:"black",linewidth:2,mirror:!0},autosize:!0},frames:[],config:{scrollZoom:!0,responsive:!1},revision:0},texEquation:"",cbNonZero:!1},a.model=null,a.modelSubmitted=a.modelSubmitted.bind(Object(f.a)(a)),a.sliderValueChanged=a.sliderValueChanged.bind(Object(f.a)(a)),a.cbNonZero_checkedChanged=a.cbNonZero_checkedChanged.bind(Object(f.a)(a)),a.textChangedCallback=a.textChangedCallback.bind(Object(f.a)(a)),a.sliderLogToggledCallback=a.sliderLogToggledCallback.bind(Object(f.a)(a)),a.modelChanged=a.modelChanged.bind(Object(f.a)(a)),a}return Object(s.a)(t,[{key:"componentDidMount",value:function(){this.modelSubmitted()}},{key:"simulModel",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[0,10],t=200,r=this.model.getCompartments(),i=this.model.simulateModel(t,e,a),n=this.state.figure,o=r.length-n.data.length;if(o>0)for(var l=0;l<o;l++)n.data.push({x:[],y:[],mode:"lines",type:"scatter",name:""});else if(o<0)for(var d=0;d<-o;d++)n.data.pop();for(var c=0;c<r.length;c++)n.data[c].x=i.xVals,n.data[c].y=i.yVals[c],n.data[c].name="".concat(r[c]);return n.revision+=1,n}},{key:"textChangedCallback",value:function(a){this.setState({schemeText:a})}},{key:"modelSubmitted",value:function(a){var e=this.state.schemeText;if(""!==e&&null!==e.match(/[^\s]+/g)){var t=this.state.initData,r=this.state.ratesData;this.model=z.fromText(e);for(var i=this.model.getCompartments(),n=this.model.getLatexFormattedCompartments(),o=this.model.getRateNames(),l=new Array(i.length),d=0;d<l.length;d++){var c=d<t.length?t[d].init:this.model.initial_conditions[i[d]],s=d<t.length&&t[d].log,f="undefined"===typeof a;l[d]={texName:n[d],init:f?c:a.initialConditions[i[d]].value,log:f?s:a.initialConditions[i[d]].logSlider,min:f?0:a.initialConditions[i[d]].min,max:f?50:a.initialConditions[i[d]].max},this.model.initial_conditions[i[d]]=l[d].init}for(var m=new Array(o.length),h=0;h<o.length;h++){var u=h<r.length?r[h].fr:this.model.elem_reactions[h].forward_rate,b=h<r.length?r[h].br:this.model.elem_reactions[h].backward_rate,g=h<r.length&&r[h].log_fr,w=h<r.length&&r[h].log_br,R="undefined"===typeof a||"undefined"===typeof a.rates;m[h]={texName:o[h],fr:R?u:a.rates[h].forwardRate,br:R?b:a.rates[h].backwardRate,log_fr:R?g:a.rates[h].forwardRateLogSlider,log_br:R?w:a.rates[h].backwardRateLogSlider,min_fr:R?0:a.rates[h].forwardRateMin,max_fr:R?10:a.rates[h].forwardRateMax,min_br:R?0:a.rates[h].backwardRateMin,max_br:R?10:a.rates[h].forwardRateMax},this.model.elem_reactions[h].forward_rate=m[h].fr,this.model.elem_reactions[h].backward_rate=m[h].br}this.model.buildFunc();var x=this.simulModel(!this.state.cbNonZero);this.setState({initData:l,ratesData:m,figure:x,texEquation:this.state.cbNonZero?this.model.diffEquations:this.model.diffEquationsFRates})}else alert("Scheme is empty!")}},{key:"sliderLogToggledCallback",value:function(a,e){var t=this.state.initData,r=this.state.ratesData;switch(a){case"init":t[e].log=!t[e].log;break;case"fr":r[e].log_fr=!r[e].log_fr;break;case"br":r[e].log_br=!r[e].log_br}this.setState({initData:t,ratesData:r})}},{key:"sliderValueChanged",value:function(a,e,t){var r=parseFloat(t),i=this.state.initData,n=this.state.ratesData;switch(a){case"init":var o=this.model.getCompartments();this.model.initial_conditions[o[e]]=r,i[e].init=r;break;case"fr":this.model.elem_reactions[e].forward_rate=r,n[e].fr=r;break;case"br":this.model.elem_reactions[e].backward_rate=r,n[e].br=r}var l=this.simulModel(!this.state.cbNonZero);this.setState({figure:l,initData:i,ratesData:n})}},{key:"modelChanged",value:function(a,e){null!==e&&(this.state.schemeText=e.scheme,this.state.cbNonZero=e.nonZeroBackwardRates,this.modelSubmitted(e))}},{key:"cbNonZero_checkedChanged",value:function(a){var e=this.simulModel(!a.target.checked);this.setState({texEquation:a.target.checked?this.model.diffEquations:this.model.diffEquationsFRates,cbNonZero:a.target.checked,figure:e})}},{key:"render",value:function(){return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("p",{children:"Compartmental model simulator"}),Object(r.jsxs)(j.a,{container:!0,spacing:1,alignItems:"column",direction:"row",children:[Object(r.jsxs)(j.a,{item:!0,xs:!0,children:[Object(r.jsx)(K.a,{options:Q.sort((function(a,e){return-e.class.localeCompare(a.class)})),groupBy:function(a){return a.class},getOptionLabel:function(a){return a.name},onChange:this.modelChanged,renderInput:function(a){return Object(r.jsx)(G.a,Object(d.a)(Object(d.a)({},a),{},{label:"Kinetics models",variant:"outlined"}))}}),Object(r.jsx)(N,{schemeText:this.state.schemeText,modelSubmitCallback:this.modelSubmitted,textChangedCallback:this.textChangedCallback}),Object(r.jsx)(J.a,{control:Object(r.jsx)(W.a,{color:"secondary",checked:this.state.cbNonZero,onChange:this.cbNonZero_checkedChanged,name:"cbNonZero"}),label:"Non-zero backwards rates"}),Object(r.jsx)(B.BlockMath,{math:"\\begin{aligned} ".concat(this.state.texEquation," \\end{aligned}"),errorColor:"#cc0000"}),Object(r.jsx)(E,{data:this.state.initData,sliderChangedCallback:this.sliderValueChanged,sliderLogToggledCallback:this.sliderLogToggledCallback}),Object(r.jsx)(D,{data:this.state.ratesData,sliderChangedCallback:this.sliderValueChanged,sliderLogToggledCallback:this.sliderLogToggledCallback,disabled:!this.state.cbNonZero})]}),Object(r.jsx)(j.a,{item:!0,xs:!0,children:Object(r.jsx)(Y,{data:this.state.figure.data,frames:this.state.figure.frames,config:this.state.figure.config,layout:this.state.figure.layout,revision:this.state.figure.revision})})]})]})}}]),t}(n.a.Component),aa=function(a){a&&a instanceof Function&&t.e(3).then(t.bind(null,158)).then((function(e){var t=e.getCLS,r=e.getFID,i=e.getFCP,n=e.getLCP,o=e.getTTFB;t(a),r(a),i(a),n(a),o(a)}))};l.a.render(Object(r.jsx)(n.a.StrictMode,{children:Object(r.jsx)($,{})}),document.getElementById("root")),aa()}},[[96,1,2]]]);
//# sourceMappingURL=main.dddc735c.chunk.js.map